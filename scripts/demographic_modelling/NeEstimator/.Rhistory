knitr::opts_chunk$set(echo = TRUE)
#Install Packages (https://github.com/zakrobinson/RLDNe/blob/master/README.md)
#devtools::install_github(repo="zakrobinson/RLDNe")
#install.packages("vcfR")
#install.packages("tidyverse")
#Load Packages
library(RLDNe)
library(vcfR)
knitr::opts_chunk$set(echo = TRUE)
#Install Packages (https://github.com/zakrobinson/RLDNe/blob/master/README.md)
devtools::install_github(repo="zakrobinson/RLDNe")
install.packages("vcfR")
install.packages("tidyverse")
#Load Packages
library(RLDNe)
library(vcfR)
install.packages("tidyverse")
library(RLDNe)
library(vcfR)
library(tidyverse)
knitr::opts_chunk$set(echo = TRUE)
#Install Packages (https://github.com/zakrobinson/RLDNe/blob/master/README.md)
#devtools::install_github(repo="zakrobinson/RLDNe")
#install.packages("vcfR")
#install.packages("tidyverse")
#Load Packages
library(RLDNe)
library(vcfR)
library(tidyverse)
setwd("/Users/abc6435/Desktop/KROH/data/rldne")
vcf <- read.table("hKIWA_rldne.vcf", header = TRUE)
colnames(vcf) <- c("CHROM", "POS", "sam29779",
"sam383194", "sam383202", "sam383205",
"sam507264", "sam507265", "CHROM_POS")
vcf <- vcf[,c(9,3:8)]
vcf
format <- c("0/0", "0/1", "1/1")
new_format <- c(0, 1, 2)
replace(vcf$sam29779, vcf$sam29779 %in% format, new_format)
vcf$sam29779
format <- c("0/0", "0/1", "1/1")
new_format <- c("0", "1", "2")
replace(vcf$sam29779, vcf$sam29779 %in% format, new_format)
replace(vcf$sam29779, vcf$sam29779=="0/0", 0)
vcf$sam29779
replace(vcf$sam29779, vcf$sam29779=="0/0", 0)
vcf$sam29779 <- replace(vcf$sam29779, vcf$sam29779=="0/0", 0)
vcf$sam29779 <- replace(vcf$sam29779, vcf$sam29779=="0/1", 1)
vcf$sam29779 <- replace(vcf$sam29779, vcf$sam29779=="1/1", 2)
vcf$sam29779
vcf$sam383194
setwd("/Users/abc6435/Desktop/KROH/data/rldne")
vcf <- read.table("hKIWA_rldne.vcf", header = TRUE)
colnames(vcf) <- c("CHROM", "POS", "sam29779",
"sam383194", "sam383202", "sam383205",
"sam507264", "sam507265", "CHROM_POS")
vcf <- vcf[,c(9,3:8)]
#Replace 0/0, 0/1, 1/1
vcf$sam29779 <- replace(vcf$sam29779, vcf$sam29779=="0/0", 0)
vcf$sam29779 <- replace(vcf$sam29779, vcf$sam29779=="0/1", 1)
vcf$sam29779 <- replace(vcf$sam29779, vcf$sam29779=="1/1", 2)
vcf$sam383194 <- replace(vcf$sam383194, vcf$sam383194=="0/0", 0)
vcf$sam383194 <- replace(vcf$sam383194, vcf$sam383194=="0/1", 1)
vcf$sam383194 <- replace(vcf$sam383194, vcf$sam383194=="1/1", 2)
vcf$sam383202 <- replace(vcf$sam383202, vcf$sam383202=="0/0", 0)
vcf$sam383202 <- replace(vcf$sam383202, vcf$sam383202=="0/1", 1)
vcf$sam383202 <- replace(vcf$sam383202, vcf$sam383202=="1/1", 2)
vcf$sam383205 <- replace(vcf$sam383205, vcf$sam383205=="0/0", 0)
vcf$sam383205 <- replace(vcf$sam383205, vcf$sam383205=="0/1", 1)
vcf$sam383205 <- replace(vcf$sam383205, vcf$sam383205=="1/1", 2)
vcf$sam507264 <- replace(vcf$sam507264, vcf$sam507264=="0/0", 0)
vcf$sam507264 <- replace(vcf$sam507264, vcf$sam507264=="0/1", 1)
vcf$sam507264 <- replace(vcf$sam507264, vcf$sam507264=="1/1", 2)
vcf$sam507265 <- replace(vcf$sam507265, vcf$sam507265=="0/0", 0)
vcf$sam507265 <- replace(vcf$sam507265, vcf$sam507265=="0/1", 1)
vcf$sam507265 <- replace(vcf$sam507265, vcf$sam507265=="1/1", 2)
vcf
transpose(vcf)
typeof(vcf)
as.data.frame(vcf)
transpose(vcf)
as.data.frame(t(vcf))
setwd("/Users/abc6435/Desktop/KROH/data/rldne")
vcf <- read.table("hKIWA_rldne.vcf", header = TRUE)
colnames(vcf) <- c("CHROM", "POS", "sam29779",
"sam383194", "sam383202", "sam383205",
"sam507264", "sam507265", "CHROM_POS")
vcf <- vcf[,c(9,3:8)]
#Replace 0/0, 0/1, 1/1
vcf$sam29779 <- replace(vcf$sam29779, vcf$sam29779=="0/0", 0)
vcf$sam29779 <- replace(vcf$sam29779, vcf$sam29779=="0/1", 1)
vcf$sam29779 <- replace(vcf$sam29779, vcf$sam29779=="1/1", 2)
vcf$sam383194 <- replace(vcf$sam383194, vcf$sam383194=="0/0", 0)
vcf$sam383194 <- replace(vcf$sam383194, vcf$sam383194=="0/1", 1)
vcf$sam383194 <- replace(vcf$sam383194, vcf$sam383194=="1/1", 2)
vcf$sam383202 <- replace(vcf$sam383202, vcf$sam383202=="0/0", 0)
vcf$sam383202 <- replace(vcf$sam383202, vcf$sam383202=="0/1", 1)
vcf$sam383202 <- replace(vcf$sam383202, vcf$sam383202=="1/1", 2)
vcf$sam383205 <- replace(vcf$sam383205, vcf$sam383205=="0/0", 0)
vcf$sam383205 <- replace(vcf$sam383205, vcf$sam383205=="0/1", 1)
vcf$sam383205 <- replace(vcf$sam383205, vcf$sam383205=="1/1", 2)
vcf$sam507264 <- replace(vcf$sam507264, vcf$sam507264=="0/0", 0)
vcf$sam507264 <- replace(vcf$sam507264, vcf$sam507264=="0/1", 1)
vcf$sam507264 <- replace(vcf$sam507264, vcf$sam507264=="1/1", 2)
vcf$sam507265 <- replace(vcf$sam507265, vcf$sam507265=="0/0", 0)
vcf$sam507265 <- replace(vcf$sam507265, vcf$sam507265=="0/1", 1)
vcf$sam507265 <- replace(vcf$sam507265, vcf$sam507265=="1/1", 2)
vcf_t <- as.data.frame(t(vcf))
vcf_t
View(vcf_t)
vcf_t[1,]
vcf_t[2,]
head(vcf_t[1,])
View(vcf_t)
colnames(vcf_t) <- vcf_t[1,]
vcf_t <- vcf_t[-1,]
vcf <- read.vcfR("/Users/abc6435/Desktop/KROH/data/rldne/hKIWA_tags_auto_bi_gtdp_gtgq_nmiss.vcf.gz")
vcf <- read.vcfR("/Users/abc6435/Desktop/KROH/data/rldne/hKIWA_tags_auto_bi_gtdp_gtgq_nmiss.vcf")
install.packages("adegenet")
install.packages("adegenet")
install.packages("pegas")
knitr::opts_chunk$set(echo = TRUE)
#Install Packages (https://github.com/zakrobinson/RLDNe/blob/master/README.md)
#devtools::install_github(repo="zakrobinson/RLDNe")
#install.packages("vcfR")
#install.packages("tidyverse")
#install.packages("adegenet")
#install.packages("pegas")
#Load Packages
library(RLDNe)
library(vcfR)
library(tidyverse)
library(adegenet)
library(pegas)
library(dplyr)
vcf <- read.vcfR("/Users/abc6435/Desktop/KROH/data/rldne/hKIWA_tags_auto_bi_gtdp_gtgq_nmiss.vcf")
genind_obj <- vcfR2genind(vcf)
genind_obj
write.genepop(genind_obj, file = "data.gen")
library(pegas)
write.genepop(genind_obj, file = "data.gen")
loci_obj <- pegas::as.loci(genind_obj)
loci_obj
pegas:::write.loci(loci_obj, format = "genepop", file = "data.gen")
pegas:::write.loci(loci_obj, file = "data.gen")
pegas:::write.loci(loci_obj, file = "/Users/annamariacalderon/Desktop/KROH/data/rldne/data.gen")
pegas:::write.loci(loci_obj, file = "/Users/abc6435/Desktop/KROH/data/rldne/data.gen")
result <- LDNe(file = "/Users/abc6435/Desktop/KROH/data/rldne/data.gen", Ne_method = "LDNe", crit.MAF = 0.05)
library(RLDNe)
result <- ldne(file = "/Users/abc6435/Desktop/KROH/data/rldne/data.gen", Ne_method = "LDNe", crit.MAF = 0.05)
result <- rldne::ldne(file = "/Users/abc6435/Desktop/KROH/data/rldne/data.gen", Ne_method = "LDNe", crit.MAF = 0.05)
result <- RLDNe::ldne(file = "/Users/abc6435/Desktop/KROH/data/rldne/data.gen", Ne_method = "LDNe", crit.MAF = 0.05)
LDNe    result <- run_LDNe(file = "/Users/abc6435/Desktop/KROH/data/rldne/data.gen", Ne_method = "LDNe", crit.MAF = 0.05)
result <- run_LDNe(file = "/Users/abc6435/Desktop/KROH/data/rldne/data.gen", Ne_method = "LDNe", crit.MAF = 0.05)
result <- RLDNe::run_LDNe(file = "/Users/abc6435/Desktop/KROH/data/rldne/data.gen", Ne_method = "LDNe", crit.MAF = 0.05)
RLDNe::run_LDNe(file = "/Users/abc6435/Desktop/KROH/data/rldne/data.gen", Ne_method = "LDNe", crit.MAF = 0.05)
result <- run_LDNe("data.gen", method = "LDNe", MAF_criteria = 0.05)
