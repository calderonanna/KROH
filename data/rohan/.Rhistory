color = "violet",
size = 2,
alpha=0.7,
show.legend = FALSE) +
geom_point(aes(y = mid * 5000),
color = "green",
size = 2,
alpha=0.7,
show.legend = FALSE) +
geom_errorbar(aes(y=thetamid*5000, ymin=thetamin*5000, ymax=thetamax*5000),
color = "violet",
width = 0.3,
alpha=0.7) +
geom_errorbar(aes(y=mid*5000, ymin=min*5000, ymax=max*5000),
color = "green",
width = 0.3,
alpha=0.7) +
scale_fill_manual(values=c("gray","black")) +
scale_y_continuous(name = "Segments in ROH (%)",
expand = c(0,0.2),
sec.axis =
sec_axis(~./5000, name=expression("Genome-wide " * theta))) +
labs(x = NULL) +
theme(
panel.background = element_blank(),
panel.grid = element_blank(),
panel.border = element_rect(color = "black", fill = NA),
legend.background = element_blank(),
legend.title = element_blank(),
legend.position = "top",
axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5))
ggplot(roh_theta, aes(x=sample, y=fROH, fill=pop)) +
geom_bar(stat="identity") +
geom_point(aes(y = thetamid * 5000),
color = "#B3669F",
size = 2,
alpha=0.9,
show.legend = FALSE) +
geom_point(aes(y = mid * 5000),
color = "#66B37B",
size = 2,
alpha=0.9,
show.legend = FALSE) +
geom_errorbar(aes(y=thetamid*5000, ymin=thetamin*5000, ymax=thetamax*5000),
color = "#B3669F",
width = 0.3,
alpha=0.9) +
geom_errorbar(aes(y=mid*5000, ymin=min*5000, ymax=max*5000),
color = "#66B37B",
width = 0.3,
alpha=0.9) +
scale_fill_manual(values=c("gray","black")) +
scale_y_continuous(name = "Segments in ROH (%)",
expand = c(0,0.2),
sec.axis =
sec_axis(~./5000, name=expression("Genome-wide " * theta))) +
labs(x = NULL) +
theme(
panel.background = element_blank(),
panel.grid = element_blank(),
panel.border = element_rect(color = "black", fill = NA),
legend.background = element_blank(),
legend.title = element_blank(),
legend.position = "top",
axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5))
ggplot(roh_theta, aes(x=sample, y=fROH, fill=pop)) +
geom_bar(stat="identity") +
geom_point(aes(y = thetamid * 5000),
color = "#B3669F",
size = 2,
alpha=1.0,
show.legend = FALSE) +
geom_point(aes(y = mid * 5000),
color = "#66B37B",
size = 2,
alpha=0.8,
show.legend = FALSE) +
geom_errorbar(aes(y=thetamid*5000, ymin=thetamin*5000, ymax=thetamax*5000),
color = "#B3669F",
width = 0.3,
alpha=1.0) +
geom_errorbar(aes(y=mid*5000, ymin=min*5000, ymax=max*5000),
color = "#66B37B",
width = 0.3,
alpha=0.8) +
scale_fill_manual(values=c("gray","black")) +
scale_y_continuous(name = "Segments in ROH (%)",
expand = c(0,0.2),
sec.axis =
sec_axis(~./5000, name=expression("Genome-wide " * theta))) +
labs(x = NULL) +
theme(
panel.background = element_blank(),
panel.grid = element_blank(),
panel.border = element_rect(color = "black", fill = NA),
legend.background = element_blank(),
legend.title = element_blank(),
legend.position = "top",
axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5))
ggplot(roh_theta, aes(x=sample, y=fROH, fill=pop)) +
geom_bar(stat="identity") +
geom_point(aes(y = thetamid * 5000),
color = "#00F7FF",
size = 2,
alpha=1.0,
show.legend = FALSE) +
geom_point(aes(y = mid * 5000),
color = "#FF0800",
size = 2,
alpha=0.8,
show.legend = FALSE) +
geom_errorbar(aes(y=thetamid*5000, ymin=thetamin*5000, ymax=thetamax*5000),
color = "#00F7FF",
width = 0.3,
alpha=1.0) +
geom_errorbar(aes(y=mid*5000, ymin=min*5000, ymax=max*5000),
color = "#FF0800",
width = 0.3,
alpha=0.8) +
scale_fill_manual(values=c("gray","black")) +
scale_y_continuous(name = "Segments in ROH (%)",
expand = c(0,0.2),
sec.axis =
sec_axis(~./5000, name=expression("Genome-wide " * theta))) +
labs(x = NULL) +
theme(
panel.background = element_blank(),
panel.grid = element_blank(),
panel.border = element_rect(color = "black", fill = NA),
legend.background = element_blank(),
legend.title = element_blank(),
legend.position = "top",
axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5))
ggplot(roh_theta, aes(x=sample, y=fROH, fill=pop)) +
geom_bar(stat="identity") +
geom_point(aes(y = thetamid * 5000),
color = "#C6FFAD",
size = 2,
alpha=1.0,
show.legend = FALSE) +
geom_point(aes(y = mid * 5000),
color = "#E6ADFF",
size = 2,
alpha=0.8,
show.legend = FALSE) +
geom_errorbar(aes(y=thetamid*5000, ymin=thetamin*5000, ymax=thetamax*5000),
color = "#C6FFAD",
width = 0.3,
alpha=1.0) +
geom_errorbar(aes(y=mid*5000, ymin=min*5000, ymax=max*5000),
color = "#E6ADFF",
width = 0.3,
alpha=0.8) +
scale_fill_manual(values=c("gray","black")) +
scale_y_continuous(name = "Segments in ROH (%)",
expand = c(0,0.2),
sec.axis =
sec_axis(~./5000, name=expression("Genome-wide " * theta))) +
labs(x = NULL) +
theme(
panel.background = element_blank(),
panel.grid = element_blank(),
panel.border = element_rect(color = "black", fill = NA),
legend.background = element_blank(),
legend.title = element_blank(),
legend.position = "top",
axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5))
ggplot(roh_theta, aes(x=sample, y=fROH, fill=pop)) +
geom_bar(stat="identity") +
geom_point(aes(y = thetamid * 5000),
color = "#00FF45",
size = 2,
alpha=1.0,
show.legend = FALSE) +
geom_point(aes(y = mid * 5000),
color = "#FF00BB",
size = 2,
alpha=0.8,
show.legend = FALSE) +
geom_errorbar(aes(y=thetamid*5000, ymin=thetamin*5000, ymax=thetamax*5000),
color = "#00FF45",
width = 0.3,
alpha=1.0) +
geom_errorbar(aes(y=mid*5000, ymin=min*5000, ymax=max*5000),
color = "#FF00BB",
width = 0.3,
alpha=0.8) +
scale_fill_manual(values=c("gray","black")) +
scale_y_continuous(name = "Segments in ROH (%)",
expand = c(0,0.2),
sec.axis =
sec_axis(~./5000, name=expression("Genome-wide " * theta))) +
labs(x = NULL) +
theme(
panel.background = element_blank(),
panel.grid = element_blank(),
panel.border = element_rect(color = "black", fill = NA),
legend.background = element_blank(),
legend.title = element_blank(),
legend.position = "top",
axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5))
knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)
library(tidyverse)
library(dplyr)
knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)
library(tidyverse)
library(dplyr)
setwd("/Users/annamariacalderon/Desktop/KROH/data/rohan")
#Segments in ROH (%)
roh <- read.table("percent_ROH.txt", header=TRUE)
colnames(roh) <- c("sample", "fROH", "CI")
roh$sample <- as.character(roh$sample)
roh$pop <- c(rep("ckIWA",7), rep("hKIWA",6))
roh$sample <- factor(roh$sample,
levels = c("183194841","183195304","183195332",
"183195312","183195321","183194861",
"183195326","507264","29779",
"383194", "383202","383205","507265"))
# Genome-wide theta outside ROH
theta_o_roh <- read.table("gw_theta_outside_ROH.txt", header=TRUE)
# Genome-wide theta including ROH
theta_inc_roh <- read.table("gw_theta_inc_ROH.txt", header=TRUE)
colnames(theta_inc_roh) <- c("sample","mid","min","max")
#Combine Data
roh_theta <- cbind(roh,
theta_o_roh[,c("thetamid", "thetamin","thetamax")],
theta_inc_roh[,c("mid", "min","max")])
#nroh_sroh
nroh_sroh <- read.table("nroh_sroh.txt", header=TRUE)
setwd("/Users/annamariacalderon/Desktop/KROH/data/rohan")
#Segments in ROH (%)
roh <- read.table("percent_ROH.txt", header=TRUE)
colnames(roh) <- c("sample", "fROH", "CI")
roh$sample <- as.character(roh$sample)
roh$pop <- c(rep("ckIWA",7), rep("hKIWA",6))
roh$sample <- factor(roh$sample,
levels = c("183194841","183195304","183195332",
"183195312","183195321","183194861",
"183195326","507264","29779",
"383194", "383202","383205","507265"))
# Genome-wide theta outside ROH
theta_o_roh <- read.table("gw_theta_outside_ROH.txt", header=TRUE)
# Genome-wide theta including ROH
theta_inc_roh <- read.table("gw_theta_inc_ROH.txt", header=TRUE)
colnames(theta_inc_roh) <- c("sample","mid","min","max")
#Combine Data
roh_theta <- cbind(roh,
theta_o_roh[,c("thetamid", "thetamin","thetamax")],
theta_inc_roh[,c("mid", "min","max")])
#nroh_sroh
nroh_sroh <- read.table("nroh_sroh.txt", header=TRUE, na.strings = c("NA", ""))
read.table("nroh_sroh.txt", header=TRUE)
setwd("/Users/annamariacalderon/Desktop/KROH/data/rohan")
read.table("nroh_sroh.txt", header=TRUE)
read.table("nroh_sroh.txt", header=TRUE, na.strings = " ",)
read.table("nroh_sroh.txt", header=TRUE, blank.lines.skip = TRUE)
read.table("nroh_sroh.txt", header=TRUE, fill = TRUE)
read.csv("nroh_sroh.txt", header=TRUE, fill = TRUE)
setwd("/Users/annamariacalderon/Desktop/KROH/data/rohan")
#Segments in ROH (%)
roh <- read.table("percent_ROH.txt", header=TRUE)
colnames(roh) <- c("sample", "fROH", "CI")
roh$sample <- as.character(roh$sample)
roh$pop <- c(rep("ckIWA",7), rep("hKIWA",6))
roh$sample <- factor(roh$sample,
levels = c("183194841","183195304","183195332",
"183195312","183195321","183194861",
"183195326","507264","29779",
"383194", "383202","383205","507265"))
# Genome-wide theta outside ROH
theta_o_roh <- read.table("gw_theta_outside_ROH.txt", header=TRUE)
# Genome-wide theta including ROH
theta_inc_roh <- read.table("gw_theta_inc_ROH.txt", header=TRUE)
colnames(theta_inc_roh) <- c("sample","mid","min","max")
#Combine Data
roh_theta <- cbind(roh,
theta_o_roh[,c("thetamid", "thetamin","thetamax")],
theta_inc_roh[,c("mid", "min","max")])
#nroh_sroh
nroh_sroh <- read.csv("nroh_sroh.txt", header=TRUE, fill = TRUE)
nroh_sroh[is.na(nroh_sroh)] <- 0
nroh_sroh
nroh_sroh$pop <- c(rep("ckIWA",21), rep("hKIWA",18))
nroh_sroh
ggplot(nroh_sroh, aes(x=sroh, y=nroh, fill=pop)) +
geom_point()
ggplot(nroh_sroh, aes(x=sroh, y=nroh, fill=pop)) +
geom_point() +
facet_wrap(~hmm_posterior_decoding)
ggplot(nroh_sroh, aes(x=sroh, y=nroh, fill=pop)) +
geom_point() +
scale_color_manual(values = c("gray","black")) +
facet_wrap(~hmm_posterior_decoding)
setwd("/Users/annamariacalderon/Desktop/KROH/data/rohan")
#Segments in ROH (%)
roh <- read.table("percent_ROH.txt", header=TRUE)
colnames(roh) <- c("sample", "fROH", "CI")
roh$sample <- as.character(roh$sample)
roh$pop <- c(rep("ckIWA",7), rep("hKIWA",6))
roh$sample <- factor(roh$sample,
levels = c("183194841","183195304","183195332",
"183195312","183195321","183194861",
"183195326","507264","29779",
"383194", "383202","383205","507265"))
# Genome-wide theta outside ROH
theta_o_roh <- read.table("gw_theta_outside_ROH.txt", header=TRUE)
# Genome-wide theta including ROH
theta_inc_roh <- read.table("gw_theta_inc_ROH.txt", header=TRUE)
colnames(theta_inc_roh) <- c("sample","mid","min","max")
#Combine Data
roh_theta <- cbind(roh,
theta_o_roh[,c("thetamid", "thetamin","thetamax")],
theta_inc_roh[,c("mid", "min","max")])
#nroh_sroh
nroh_sroh <- read.csv("nroh_sroh.txt", header=TRUE, fill = TRUE)
nroh_sroh[is.na(nroh_sroh)] <- 0
nroh_sroh$pop <- c(rep("ckIWA",21), rep("hKIWA",18))
nroh_sroh$hmm_posterior_decoding <- factor(nroh_sroh$hmm_posterior_decoding,
levels = c("min","mid","max"))
nroh_sroh$hmm_posterior_decoding
ggplot(nroh_sroh, aes(x=sroh, y=nroh, fill=pop)) +
geom_point() +
scale_color_manual(values = c("gray","black")) +
facet_wrap(~hmm_posterior_decoding)
nroh_sroh
ggplot(nroh_sroh, aes(x=sroh, y=nroh, fill=pop)) +
geom_point() +
scale_fill_manual(values = c("gray","black")) +
facet_wrap(~hmm_posterior_decoding)
ggplot(nroh_sroh, aes(x = sroh, y = nroh, color = pop)) +
geom_point() +
scale_color_manual(values = c("gray", "black")) +
facet_wrap(~hmm_posterior_decoding)
max(nroh_sroh$sroh)
ggplot(nroh_sroh, aes(x=sroh, y=nroh/1000000, fill=pop)) +
geom_point() +
scale_fill_manual(values = c("gray","black")) +
facet_wrap(~hmm_posterior_decoding)
ggplot(nroh_sroh, aes(x=sroh/1000000, y=nroh, fill=pop)) +
geom_point() +
scale_fill_manual(values = c("gray","black")) +
facet_wrap(~hmm_posterior_decoding)
ggplot(nroh_sroh, aes(x=sroh/1000000, y=nroh, fill=pop)) +
geom_point() +
scale_fill_manual(values = c("gray","black")) +
facet_wrap(~hmm_posterior_decoding)
ggplot(nroh_sroh, aes(x = sroh/1e6, y = nroh, color = pop)) +
geom_point(size = 3) +
scale_color_manual(values = c("gray", "black")) +
facet_wrap(~hmm_posterior_decoding)
ggplot(nroh_sroh, aes(x = sroh/1e6, y = nroh, color = pop)) +
geom_point(size = 1) +
scale_color_manual(values = c("gray", "black")) +
facet_wrap(~hmm_posterior_decoding)
ggplot(nroh_sroh, aes(x = sroh/1e6, y = nroh, color = pop)) +
geom_point(size = 2) +
scale_color_manual(values = c("gray", "black")) +
facet_wrap(~hmm_posterior_decoding)
ggplot(nroh_sroh, aes(x = sroh/1e6, y = nroh, color = pop)) +
geom_point(size = 2) +
scale_color_manual(values = c("gray", "black")) +
facet_wrap(~hmm_posterior_decoding) +
theme(
panel.background = element_blank(),
panel.grid = element_blank(),
panel.border = element_rect(color = "black", fill = NA),
legend.background = element_blank(),
legend.title = element_blank(),
legend.position = "top")
ggplot(nroh_sroh, aes(x = sroh/1e6, y = nroh, color = pop)) +
geom_point(size = 2) +
scale_color_manual(values = c("gray", "black")) +
facet_wrap(~hmm_posterior_decoding) +
xlab("SROH (Mb)") +
theme(
panel.background = element_blank(),
panel.grid = element_blank(),
panel.border = element_rect(color = "black", fill = NA),
legend.background = element_blank(),
legend.title = element_blank(),
legend.position = "top")
ggplot(nroh_sroh, aes(x = sroh/1e6, y = nroh, color = pop)) +
geom_point(size = 2) +
scale_color_manual(values = c("gray", "black")) +
facet_wrap(~hmm_posterior_decoding) +
xlab("SROH (Mb)") +
theme(
panel.background = element_blank(),
panel.grid = element_blank(),
panel.border = element_rect(color = "black", fill = NA),
legend.background = element_blank(),
legend.title = element_blank(),
legend.position = NULL)
ggplot(nroh_sroh, aes(x = sroh/1e6, y = nroh, color = pop)) +
geom_point(size = 2) +
scale_color_manual(values = c("gray", "black")) +
facet_wrap(~hmm_posterior_decoding) +
xlab("SROH (Mb)") +
theme(
panel.background = element_blank(),
panel.grid = element_blank(),
panel.border = element_rect(color = "black", fill = NA),
legend.background = element_blank(),
legend.title = element_blank(),
legend.position = "none")
ggplot(nroh_sroh, aes(x = sroh/1e6, y = nroh, color = pop)) +
geom_point(size = 2) +
scale_color_manual(values = c("gray", "black")) +
facet_wrap(~hmm_posterior_decoding,
strip = strip_themed(background_x = elem_list_rect(fill = rainbow(3)))) +
xlab("SROH (Mb)") +
theme(
panel.background = element_blank(),
panel.grid = element_blank(),
panel.border = element_rect(color = "black", fill = NA),
legend.background = element_blank(),
legend.title = element_blank(),
legend.position = "none")
ggplot(nroh_sroh, aes(x = sroh/1e6, y = nroh, color = pop)) +
geom_point(size = 2) +
scale_color_manual(values = c("gray", "black")) +
facet_wrap(~hmm_posterior_decoding) +
xlab("SROH (Mb)") +
theme(strip.background=element_rect(colour="black", fill="yellow"),
panel.background = element_blank(),
panel.grid = element_blank(),
panel.border = element_rect(color = "black", fill = NA),
legend.background = element_blank(),
legend.title = element_blank(),
legend.position = "none")
v
ggplot(nroh_sroh, aes(x = sroh/1e6, y = nroh, color = pop)) +
geom_point(size = 2) +
scale_color_manual(values = c("gray", "black")) +
facet_wrap(~hmm_posterior_decoding) +
xlab("SROH (Mb)") +
theme(strip.background=element_rect(colour="black",
fill=c("yellow","pink","brown")),
panel.background = element_blank(),
panel.grid = element_blank(),
panel.border = element_rect(color = "black", fill = NA),
legend.background = element_blank(),
legend.title = element_blank(),
legend.position = "none")
ggplot(nroh_sroh, aes(x = sroh/1e6, y = nroh, color = pop)) +
geom_point(size = 2) +
scale_color_manual(values = c("gray", "black")) +
facet_wrap(~hmm_posterior_decoding) +
xlab("SROH (Mb)") +
strip_themed_background(
fill = c("yellow", "pink", "brown"),   # one per facet
color = "black"
) +
theme(
panel.background = element_blank(),
panel.grid = element_blank(),
panel.border = element_rect(color = "black", fill = NA),
legend.background = element_blank(),
legend.title = element_blank(),
legend.position = "none")
ggplot(nroh_sroh, aes(x = sroh/1e6, y = nroh, color = pop)) +
geom_point(size = 2) +
scale_color_manual(values = c("gray", "black")) +
facet_wrap(~hmm_posterior_decoding) +
xlab("SROH (Mb)") +
theme(
panel.background = element_blank(),
panel.grid = element_blank(),
panel.border = element_rect(color = "black", fill = NA),
legend.background = element_blank(),
legend.title = element_blank(),
legend.position = "none")
ggplot(nroh_sroh, aes(x = sroh/1e6, y = nroh, color = pop)) +
geom_point(size = 2) +
scale_color_manual(values = c("gray", "black")) +
facet_wrap(~hmm_posterior_decoding, scales = "free_x") +
xlab("SROH (Mb)") +
theme(
panel.background = element_blank(),
panel.grid = element_blank(),
panel.border = element_rect(color = "black", fill = NA),
legend.background = element_blank(),
legend.title = element_blank(),
legend.position = "none")
ggplot(nroh_sroh, aes(x = sroh/1e6, y = nroh, color = pop)) +
geom_point(size = 2) +
scale_color_manual(values = c("gray", "black")) +
facet_wrap(~hmm_posterior_decoding, scales = "free_x") +
xlab("SROH (Mb)") +
ylab("NROH") +
theme(
panel.background = element_blank(),
panel.grid = element_blank(),
panel.border = element_rect(color = "black", fill = NA),
legend.background = element_blank(),
legend.title = element_blank(),
legend.position = "none")
ggplot(nroh_sroh, aes(x = sroh/1e6, y = nroh, color = pop)) +
geom_point(size = 2) +
scale_color_manual(values = c("gray", "black")) +
facet_wrap(~hmm_posterior_decoding, scales = "free_x") +
xlab("SROH (Mb)") +
ylab("NROH") +
theme(
panel.background = element_blank(),
panel.grid = element_blank(),
panel.border = element_rect(color = "black", fill = NA),
legend.background = element_blank(),
legend.title = element_blank(),
legend.position = "none")
