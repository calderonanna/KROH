initialize() {
	
	// MUTATION RATE (Smeds et al. 2016)
	initializeMutationRate(4.6e-9);
	
	
	// PER BP RECOMBINATION RATE (2Mb/cM; r=5e-9)
	initializeRecombinationRate(5e-9);
	
	
	// MUTATION TYPES
	
	// deleterious
	initializeMutationType("m2", 0.2, "g", -0.03, 0.2);
	
	
	// GENOMIC ELEMENT TYPES (only exons)
	// exons ((snyonymous/nonsynonymous)
	initializeGenomicElementType("g3", c(m1,m3), c(10,1));
	
	
	// GENOMIC STRUCTURE
	// exons
	lines = readFile("~/Desktop/KROH/data/slim/rxy/chr29_exons.txt");
	for (line in lines)
	{
		components = strsplit(line, "\t");
		initializeGenomicElement(g3, asInteger(components[0])-1, asInteger(components[1])-1);
	}
}


// SIMULATE POPULATION
1 early() {
	sim.addSubpop("p1", 500);
}

// output samples of 10 haplosomes periodically, all fixed mutations at end
//10*popsize = # generations

1000 late() { p1.outputSample(10); }
2000 late() { p1.outputSample(10); }
200000 late() { sim.outputFixedMutations(); }

// schedule a committe meeting (next semester)
