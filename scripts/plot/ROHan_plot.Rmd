---
title: "ROHan"
output: html_document
date: "2025-10-31"
---

# Set Up

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)
library(tidyverse)
library(dplyr)
```

# Import Data

read.table("gw_theta_outside_ROH.txt", header=TRUE)

```{r import_datq, include=FALSE}
setwd("/Users/annamariacalderon/Desktop/KROH/data/rohan")
#Segments in ROH (%)
roh <- read.table("percent_ROH.txt", header=TRUE)
colnames(roh) <- c("sample", "fROH", "CI")
roh$sample <- as.character(roh$sample)
roh$pop <- c(rep("ckIWA",7), rep("hKIWA",6))
roh$sample <- factor(roh$sample,
                     levels = c("183194841","183195304","183195332",
                                "183195312","183195321","183194861",
                                "183195326","507264","29779", 
                                "383194", "383202","383205","507265"))

# Genome-wide theta outside ROH
theta_o_roh <- read.table("gw_theta_outside_ROH.txt", header=TRUE)

# Genome-wide theta including ROH
theta_inc_roh <- read.table("gw_theta_inc_ROH.txt", header=TRUE)
colnames(theta_inc_roh) <- c("sample","mid","min","max")

#Combine Data
roh_theta <- cbind(roh, 
                   theta_o_roh[,c("thetamid", "thetamin","thetamax")],
                   theta_inc_roh[,c("mid", "min","max")])


```

# Plot

```{r plot, include=FALSE}
ggplot(roh_theta, aes(x=sample, y=fROH, fill=pop)) +
  geom_bar(stat="identity") +
  geom_point(aes(y = thetamid * 5000), 
             color = "red", 
             size = 2,
             show.legend = FALSE) +
    geom_point(aes(y = mid * 5000), 
             color = "blue", 
             size = 2,
             show.legend = FALSE) +
  scale_fill_manual(values=c("gray","black")) +
  scale_y_continuous(
    name = "Segments in ROH (%)",
    expand = c(0,0.2),
    sec.axis = sec_axis(~./5000, 
                        name = expression("Genome-wide " * theta))) +
  geom_errorbar(aes(y=thetamid*5000, ymin=thetamin*5000, ymax=thetamax*5000),
                color = "red",
                width = 0.3) +
  geom_errorbar(aes(y=mid*5000, ymin=min*5000, ymax=max*5000),
                color = "blue",
                width = 0.3) +
  labs(x = NULL) +
  theme(
    panel.background = element_blank(),
    panel.grid = element_blank(),
    panel.border = element_rect(color = "black", fill = NA),
    legend.background = element_blank(),
    legend.title = element_blank(),
    legend.position = "top",
    axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5)
  )

```
