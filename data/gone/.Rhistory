#Read in csv
cit_del_sfs <- read.csv("//Users/annamariacalderon/Desktop/SFS/1D_SFS/DEL_citrina_DAFpop0.obs", header = FALSE, sep = ",")
cit_tol_sfs <- read.csv("/Users/annamariacalderon/Desktop/SFS/1D_SFS/TOL_citrina_DAFpop0.obs", header = FALSE, sep = ",")
cit_nonsyn_sfs <- read.csv("/Users/annamariacalderon/Desktop/SFS/1D_SFS/NONSYN_citrina_DAFpop0.obs", header = FALSE, sep = ",")
cit_syn_sfs <- read.csv("/Users/annamariacalderon/Desktop/SFS/1D_SFS/SYN_citrina_DAFpop0.obs", header = FALSE, sep = ",")
cit_lof_sfs <- read.csv("/Users/annamariacalderon/Desktop/SFS/1D_SFS/LOF_citrina_DAFpop0.obs", header = FALSE, sep = ",")
cit_noncode_sfs <- read.csv("/Users/annamariacalderon/Desktop/SFS/1D_SFS/NONCODE_citrina_DAFpop0.obs", header = FALSE, sep = ",")
colnames(cit_del_sfs) <- cit_del_sfs[1,]
cit_del_sfs = cit_del_sfs[2,]
cit_del_sfs[,"MUTATION_TYPE"] = 'DEL'
cit_del_sfs
colnames(cit_tol_sfs) <- cit_tol_sfs[1,]
cit_tol_sfs = cit_tol_sfs[2,]
cit_tol_sfs[,"MUTATION_TYPE"] = 'TOL'
cit_tol_sfs
colnames(cit_nonsyn_sfs) <- cit_nonsyn_sfs[1,]
cit_nonsyn_sfs = cit_nonsyn_sfs[2,]
cit_nonsyn_sfs[,"MUTATION_TYPE"] = 'NONSYN'
cit_nonsyn_sfs
CIT_SFS <- rbind(cit_tol_sfs, cit_syn_sfs, cit_noncode_sfs, cit_nonsyn_sfs,
cit_del_sfs, cit_lof_sfs)
CIT_SFS
CIT_SFS <- rbind(cit_tol_sfs, cit_syn_sfs, cit_noncode_sfs, cit_nonsyn_sfs, cit_del_sfs, cit_lof_sfs)
cit_syn_sfs
colnames(cit_syn_sfs) <- cit_syn_sfs[1,]
cit_syn_sfs = cit_syn_sfs[2,]
cit_syn_sfs[,"MUTATION_TYPE"] = 'SYN'
cit_syn_sfs
colnames(cit_nonsyn_sfs) <- cit_nonsyn_sfs[1,]
cit_nonsyn_sfs = cit_nonsyn_sfs[2,]
cit_nonsyn_sfs[,"MUTATION_TYPE"] = 'NONSYN'
cit_nonsyn_sfs
cit_nonsyn_sfs <- read.csv("/Users/annamariacalderon/Desktop/SFS/1D_SFS/NONSYN_citrina_DAFpop0.obs", header = FALSE, sep = ",")
cit_nonsyn_sfs
cit_nonsyn_sfs[1,]
colnames(cit_nonsyn_sfs) <- cit_nonsyn_sfs[1,]
cit_noncode_sfs
colnames(cit_nonsyn_sfs)
cit_nonsyn_sfs
cit_syn_sfs = cit_syn_sfs[2,]
cit_syn_sfs[,"MUTATION_TYPE"] = 'SYN'
cit_nonsyn_sfs
cit_nonsyn_sfs = cit_nonsyn_sfs[2,]
cit_noncode_sfs
colnames(cit_nonsyn_sfs) <- cit_nonsyn_sfs[1,]
cit_nonsyn_sfs
cit_nonsyn_sfs <- read.csv("/Users/annamariacalderon/Desktop/SFS/1D_SFS/NONSYN_citrina_DAFpop0.obs", header = FALSE, sep = ",")
cit_nonsyn_sfs
cit_tol_sfs
colnames(cit_nonsyn_sfs) <- cit_nonsyn_sfs[1,]
cit_nonsyn_sfs
cit_nonsyn_sfs[2,]
cit_nonsyn_sfs = cit_nonsyn_sfs[2,]
cit_noncode_sfs
cit_nonsyn_sfs
#Read in csv
cit_del_sfs <- read.csv("//Users/annamariacalderon/Desktop/SFS/1D_SFS/DEL_citrina_DAFpop0.obs", header = FALSE, sep = ",")
cit_tol_sfs <- read.csv("/Users/annamariacalderon/Desktop/SFS/1D_SFS/TOL_citrina_DAFpop0.obs", header = FALSE, sep = ",")
cit_nonsyn_sfs <- read.csv("/Users/annamariacalderon/Desktop/SFS/1D_SFS/NONSYN_citrina_DAFpop0.obs", header = FALSE, sep = ",")
cit_syn_sfs <- read.csv("/Users/annamariacalderon/Desktop/SFS/1D_SFS/SYN_citrina_DAFpop0.obs", header = FALSE, sep = ",")
cit_lof_sfs <- read.csv("/Users/annamariacalderon/Desktop/SFS/1D_SFS/LOF_citrina_DAFpop0.obs", header = FALSE, sep = ",")
cit_noncode_sfs <- read.csv("/Users/annamariacalderon/Desktop/SFS/1D_SFS/NONCODE_citrina_DAFpop0.obs", header = FALSE, sep = ",")
colnames(cit_del_sfs) <- cit_del_sfs[1,]
cit_del_sfs = cit_del_sfs[2,]
cit_del_sfs[,"MUTATION_TYPE"] = 'DEL'
colnames(cit_tol_sfs) <- cit_tol_sfs[1,]
cit_tol_sfs = cit_tol_sfs[2,]
cit_tol_sfs[,"MUTATION_TYPE"] = 'TOL'
colnames(cit_nonsyn_sfs) <- cit_nonsyn_sfs[1,]
cit_nonsyn_sfs = cit_nonsyn_sfs[2,]
cit_nonsyn_sfs[,"MUTATION_TYPE"] = 'NONSYN'
colnames(cit_syn_sfs) <- cit_syn_sfs[1,]
cit_syn_sfs = cit_syn_sfs[2,]
cit_syn_sfs[,"MUTATION_TYPE"] = 'SYN'
colnames(cit_lof_sfs) <- cit_lof_sfs[1,]
cit_lof_sfs = cit_lof_sfs[2,]
cit_lof_sfs[,"MUTATION_TYPE"] = 'LOF'
colnames(cit_noncode_sfs) <- cit_noncode_sfs[1,]
cit_noncode_sfs = cit_noncode_sfs[2,]
cit_noncode_sfs[,"MUTATION_TYPE"] = 'NONCODE'
CIT_SFS <- rbind(cit_tol_sfs, cit_syn_sfs, cit_noncode_sfs, cit_nonsyn_sfs, cit_del_sfs, cit_lof_sfs)
CIT_SFS_m <- melt(CIT_SFS, id.vars = "MUTATION_TYPE",variable.name = "Allele_Count")
cit_SFS_plot <- ggplot(CIT_SFS_m, aes(Allele_Count, y=value, fill=MUTATION_TYPE)) +
geom_bar(stat='identity', position = "dodge")
cit_SFS_plot
factor(CIT_SFS_m$MUTATION_TYPE,
levels = c('TOL', 'SYN', 'NONCODE',
'NONSYN', 'DEL', 'LOF'))
CIT_SFS_m$MUTATION_TYPE <- factor(CIT_SFS_m$MUTATION_TYPE,
levels = c('TOL', 'SYN', 'NONCODE',
'NONSYN', 'DEL', 'LOF'))
cit_SFS_plot <- ggplot(CIT_SFS_m, aes(Allele_Count, y=value, fill=MUTATION_TYPE)) +
geom_bar(stat='identity', position = "dodge")
cit_SFS_plot
cit_tol_sfs
cit_tol_sfs[,-12]
rowSums(cit_tol_sfs[,-12])
220738 +80593 +22531 +11124 +4395 +4953 +2982 +4790 +5043 +6797+19291
cit_tol_sfs[,-12]/rowSums(cit_tol_sfs[,-12])
cit_tol_sfsp <- cit_tol_sfs[,-12]/rowSums(cit_tol_sfs[,-12])
cit_tol_sfsp['MUTATION_TYPE'] = 'TOL'
cit_tol_sfsp
cit_tol_sfsp <- cit_tol_sfs[,-12]/rowSums(cit_tol_sfs[,-12])
cit_tol_sfsp['MUTATION_TYPE'] = 'TOL'
cit_del_sfsp <- cit_del_sfs[,-12]/rowSums(cit_del_sfs[,-12])
cit_del_sfsp['MUTATION_TYPE'] = 'DEL'
cit_nonsyn_sfsp <- cit_nonsyn_sfs[,-12]/rowSums(cit_nonsyn_sfs[,-12])
cit_nonsyn_sfsp['MUTATION_TYPE'] = 'NONSYN'
cit_syn_sfsp <- cit_syn_sfs[,-12]/rowSums(cit_syn_sfs[,-12])
cit_syn_sfsp['MUTATION_TYPE'] = 'SYN'
cit_lof_sfsp <- cit_lof_sfs[,-12]/rowSums(cit_lof_sfs[,-12])
cit_lof_sfsp['MUTATION_TYPE'] = 'LOF'
cit_noncode_sfsp <- cit_noncode_sfs[,-12]/rowSums(cit_noncode_sfs[,-12])
cit_noncode_sfsp['MUTATION_TYPE'] = 'NONCODE'
CIT_SFSP <- rbind(cit_tol_sfsp, cit_syn_sfsp, cit_noncode_sfsp, cit_nonsyn_sfsp, cit_del_sfsp,
cit_lof_sfsp)
CIT_SFSP_m <- melt(CIT_SFSP, id.vars = "MUTATION_TYPE", variable.name = "Allele_Count")
CIT_SFSP_m$MUTATION_TYPE <- factor(CIT_SFSP_m$MUTATION_TYPE,levels = c('TOL', 'SYN', 'NONCODE',
'NONSYN', 'DEL', 'LOF'))
cit_SFSP_plot <- ggplot(CIT_SFSP_m, aes(Allele_Count, y=value, fill=MUTATION_TYPE)) +
geom_bar(stat='identity', position = "dodge")
cit_SFSP_plot
seq(1:10)
Generation <- seq(1:10)
Geometric_mean_2M <- seq(200:210)
Geometric_mean_3M <- seq(200:210)
Geometric_mean_4M <- seq(200:210)
Ne_2M <- cbind(Generation, Geometric_mean_2M)
Ne_3M <- cbind(Generation, Geometric_mean_3M)
Ne_4M <- cbind(Generation, Geometric_mean_4M)
Generation <- seq(1:10)
Geometric_mean_2M <- seq(201:210)
Geometric_mean_3M <- seq(201:210)
Geometric_mean_4M <- seq(201:210)
Ne_2M <- cbind(Generation, Geometric_mean_2M)
Ne_3M <- cbind(Generation, Geometric_mean_3M)
Ne_4M <- cbind(Generation, Geometric_mean_4M)
Ne_2M$Sites <- "2M"
Ne_3M$Sites <- "3M"
Ne_4M$Sites <- "4M"
Ne_2M
Generation <- seq(1:10)
Geometric_mean_2M <- seq(201:210)
Geometric_mean_3M <- seq(201:210)
Geometric_mean_4M <- seq(201:210)
Generation <- seq(1:10)
Geometric_mean_2M <- seq(201:210)
Geometric_mean_3M <- seq(201:210)
Geometric_mean_4M <- seq(201:210)
Ne_2M <- as.data.frame(cbind(Generation, Geometric_mean_2M))
Ne_3M <- as.data.frame(cbind(Generation, Geometric_mean_3M))
Ne_4M <- as.data.frame(cbind(Generation, Geometric_mean_4M))
Ne_2M
seq(201:210)
seq(201:210)
sample(100:300, 10, replace = TRUE)
Generation <- seq(1:10)
Geometric_mean_2M <- sample(100:300, 10, replace = TRUE)
Geometric_mean_3M <- sample(100:300, 10, replace = TRUE)
Geometric_mean_4M <- sample(100:300, 10, replace = TRUE)
Ne_2M <- as.data.frame(cbind(Generation, Geometric_mean_2M))
Ne_3M <- as.data.frame(cbind(Generation, Geometric_mean_3M))
Ne_4M <- as.data.frame(cbind(Generation, Geometric_mean_4M))
Ne_2M$Sites <- "2M"
Ne_3M$Sites <- "3M"
Ne_4M$Sites <- "4M"
Ne_2M
Ne_3M
Ne_2M$Generation <-seq(1:10)
sample(100:300, 10, replace = TRUE)
sample(100:300, 10, replace = TRUE)
as.data.frame(cbind(Generation, sample(100:300, 10, replace = TRUE)))
Generation <- seq(1:10)
as.data.frame(cbind(Generation, sample(100:300, 10, replace = TRUE)))
Ne_2M <- as.data.frame(cbind(seq(1:10), sample(100:300, 10, replace = TRUE)))
Ne_3M <- as.data.frame(cbind(seq(1:10), sample(100:300, 10, replace = TRUE)))
Ne_4M <- as.data.frame(cbind(seq(1:10), sample(100:300, 10, replace = TRUE)))
Ne_2M$Sites <- "2M"
Ne_3M$Sites <- "3M"
Ne_4M$Sites <- "4M"
Ne_2M
Ne_2M <- as.data.frame(cbind(seq(1:10), sample(100:300, 10, replace = TRUE), "2M"))
Ne_2M
Ne_2M <- as.data.frame(cbind(seq(1:10), sample(100:300, 10, replace = TRUE), "2M"))
Ne_3M <- as.data.frame(cbind(seq(1:10), sample(100:300, 10, replace = TRUE), "3M"))
Ne_4M <- as.data.frame(cbind(seq(1:10), sample(100:300, 10, replace = TRUE), "4M"))
cbind(Ne_2M, Ne_3M, Ne_4M)
rbind(Ne_2M, Ne_3M, Ne_4M)
Ne <- rbind(Ne_2M, Ne_3M, Ne_4M)
library(ggplot2)
ggplot(data = Ne, aes(x=V1, y=V2, color=V3)) +
geom_line()
ggplot(data = Ne, aes(x=V1, y=V2)) +
geom_line()
Ne
melt(Ne, id="V3")
library(reshape2)
melt(Ne, id="V3")
melt(Ne, id="V1")
melt(Ne, id="V1", value="V2")
Ne
melt(Ne, id="V1", value="V2")
Ne
melt(Ne, id="V1", value="V3")
melt(Ne, id="V1", value="V3", variable.name = "V2")
melt(Ne, id="V1", value="V3")
Ne
melt(Ne, id="V3", value="V2")
melt(Ne, id=c("V1","V3"), value="V2")
elt(Ne, id=c("V1","V3"))
melt(Ne, id=c("V1","V3"))
elt(Ne, id.vars = c("V1","V3"), variable.name = "x",
value.name = "Ne")
melt(Ne, id.vars = c("V1","V3"), variable.name = "x",
value.name = "Ne")
melt(Ne, id.vars = "V1", variable.name = "V3",
value.name = "Ne")
melt(Ne, id.vars = "V1", variable.name = "Sites",
value.name = "Ne")
melt(Ne, id.vars = "V1", variable.name = "Sites",
value.name = "V2")
melt(Ne, id.vars = c("V1","V3"), value.name = "V2")
melt(Ne, id.vars = c("V1","V3"), value.name = "V2", variable.name = Ne$V3)
melt(Ne, id.vars = c("V1","V3"), value.name = "V2",
variable.name = "Sites")
melt(Ne, id.vars = "V3", value.name = "V2",
variable.name = "Sites")
Ne <- cbind(Ne_2M, Ne_3M, Ne_4M)
Ne
Generation <- seq(1:10)
Ne_2M <- sample(100:300, 10, replace = TRUE), "2M")
Generation <- seq(1:10)
Ne_2M <- sample(100:300, 10, replace = TRUE)
Ne_3M <- sample(100:300, 10, replace = TRUE)
Ne_4M <- sample(100:300, 10, replace = TRUE)
Ne <- cbind(Generation, Ne_2M, Ne_3M, Ne_4M)
Ne
Ne <- as.data.frame(cbind(Generation, Ne_2M, Ne_3M, Ne_4M))
Ne
melt(Ne, id.vars = "Generation", value.name = "Ne",
variable.name = "Sites")
Ne_melt <- melt(Ne, id.vars = "Generation", value.name = "Ne",
variable.name = "Sites")
ggplot(Ne_melt, aes(x=Generation, y=Ne, color=Sites)) +
geom_line()
library(ggplot2)
library(reshape2)
library(knitr)
setwd("/Users/annamariacalderon/Desktop/KROH/data/gone")
for (i in 1:70) {
R(i) <- read.table("Output_Ne_R(i)", header = TRUE)
}
for (i in 1:70) {
file_name <- paste0("Output_Ne_R", i)
}
print(file_name)
for (i in 1:70) {
Ne_R(i) <- paste0("Output_Ne_R", i)
}
for (i in 1:70) {
paste0("Output_Ne_R", i)
}
for (i in 1:70) {
paste0("Output_Ne_R", i)
}
for (i in 1:70) {
file_name <- paste0("Output_Ne_R", i)
R_list[[i]] <- read.table(file_name, header = TRUE)
}
library(ggplot2)
library(dplyr)
library(tidyr)
library(reshape2)
library(knitr)
setwd("/Users/annamariacalderon/Desktop/KROH/data/gone")
for (i in 1:70) {
file_name <- paste0("Output_Ne_R", i)
R_list[[i]] <- read.table(file_name, header = TRUE)
}
setwd("/Users/annamariacalderon/Desktop/KROH/data/gone")
for (i in 1:70) {
file_name <- paste0("Output_Ne_R", i)
R_list[[i]] <- read.table(file_name, header = TRUE)
}
library(ggplot2)
library(dyplr)
library(ggplot2)
library(dplyr)
library(tidyr)
library(reshape2)
library(knitr)
list.files(pattern="Output_Ne_*")
myFiles[1]
myFiles <- list.files(pattern="Output_Ne_*")
myFiles[1]
myFiles <- list.files(pattern="Output_Ne_*")
for (i in 1:70){
data[[i]] <- read.table(myFiles[i], header=TRUE)
}
read.table(myFiles[1], header=TRUE)
Nene_files <- list.files(pattern="Output_Ne_*")
for (i in 1:70){
ne_r[i] <- read.table(ne_files[i], header=TRUE)
}read.table(myFiles[1], header=TRUE)
ne_files <- list.files(pattern="Output_Ne_*")
for (i in 1:70){
ne_r[i] <- read.table(ne_files[i], header=TRUE)
}
paste0("ne_r", 1)
ne_files <- list.files(pattern="Output_Ne_*")
for (i in 1:70){
paste0("ne_r", i) <- read.table(ne_files[i], header=TRUE)
}
for (i in 1:70) {
ne_list[[i]] <- read.table(ne_files[i], header=TRUE)
}
ne_files <- list.files(pattern="Output_Ne_*")
ne_list <- list()
for (i in 1:70) {
ne_list[[i]] <- read.table(ne_files[i], header=TRUE)
}
ne_list[[1]]
ne_list
for (i in 1:70) {
Ne <- as.data.frame(cbind(ne_list[[i]]))
}
Ne
View(Ne)
Ne <- do.call(cbind, ne_list)
ne_list[[1]][1:120,]
for (i in 1:70) {
ne_list[[i]] <- ne_list[[i]][1:120, ]
}
Ne <- do.call(cbind, ne_list)
Ne
View(Ne)
for (i in 1:70) {
ne_list[[i]] <- ne_list[[i]][1:120, 2]
}
Ne <- do.call(cbind, ne_list)
ne_list[[1]]
colnames(ne_list[[1]])
setwd("/Users/annamariacalderon/Desktop/KROH/data/gone")
ne_files <- list.files(pattern="Output_Ne_*")
ne_list <- list()
for (i in 1:70) {
ne_list[[i]] <- read.table(ne_files[i], header=TRUE)
}
colnames(ne_list[[1]])
paste0("ne_R",1)
for (i in 1:70) {
colnames(ne_list[[i]]) <- c("Generation", paste0("ne_R",i))
ne_list[[i]] <- ne_list[[i]][1:120, 2]
}
ne_list[[1]]
for (i in 1:70) {
colnames(ne_list[[i]]) <- c("Generation", paste0("ne_R",i))
ne_list[[i]] <- ne_list[[i]][1:120, 2]
}
for (i in 1:70) {
colnames(ne_list[[i]]) <- c("Generation", paste0("ne_R",i))
}
setwd("/Users/annamariacalderon/Desktop/KROH/data/gone")
ne_files <- list.files(pattern="Output_Ne_*")
ne_list <- list()
for (i in 1:70) {
ne_list[[i]] <- read.table(ne_files[i], header=TRUE)
}
for (i in 1:70) {
colnames(ne_list[[i]]) <- c("Generation", paste0("ne_R",i))
ne_list[[i]] <- ne_list[[i]][1:120, 2]
}
Ne <- do.call(cbind, ne_list)
rownames(Ne) <- nrow(Ne)
Ne
setwd("/Users/annamariacalderon/Desktop/KROH/data/gone")
ne_files <- list.files(pattern="Output_Ne_*")
ne_list <- list()
for (i in 1:70) {
ne_list[[i]] <- read.table(ne_files[i], header=TRUE)
}
for (i in 1:70) {
colnames(ne_list[[i]]) <- c("Generation", paste0("ne_R",i))
ne_list[[i]] <- ne_list[[i]][1:120,]
}
Ne <- do.call(cbind, ne_list[[i]][,2])
ne
Ne
setwd("/Users/annamariacalderon/Desktop/KROH/data/gone")
ne_files <- list.files(pattern="Output_Ne_*")
ne_list <- list()
for (i in 1:70) {
ne_list[[i]] <- read.table(ne_files[i], header=TRUE)
}
for (i in 1:70) {
ne_list[[i]] <- ne_list[[i]][1:120,]
}
ne_list[[1]]
ne_list[[1]][,2]
for (i in 1:70) {
ne_list[[i]] <- ne_list[[i]][1:120,2]
}
ne_list[[1]]
do.call(cbind, ne_list[[i]])
setwd("/Users/annamariacalderon/Desktop/KROH/data/gone")
ne_files <- list.files(pattern="Output_Ne_*")
ne_list <- list()
for (i in 1:70) {
ne_list[[i]] <- read.table(ne_files[i], header=TRUE)
}
for (i in 1:70) {
ne_list[[i]] <- ne_list[[i]][1:120,2]
Ne <- do.call(cbind, ne_list[[i]])
}
ne_list
setwd("/Users/annamariacalderon/Desktop/KROH/data/gone")
ne_files <- list.files(pattern="Output_Ne_*")
ne_list <- list()
for (i in 1:70) {
ne_list[[i]] <- read.table(ne_files[i], header=TRUE)
}
for (i in 1:70) {
ne_list[[i]] <- ne_list[[i]][1:120, 2]
}
Ne <- do.call(cbind, ne_list)
Ne
Ne$Generation <- nrow(Ne)
Ne <- as.data.frame(Ne)
Ne
Ne <- do.call(cbind, ne_list)
Ne
as.data.frame(as.numeric(Ne))
Ne
