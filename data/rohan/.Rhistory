"383194", "383202","383205","507265"))
# Genome-wide theta outside ROH
theta_o_roh <- read.table("gw_theta_outside_ROH.txt", header=TRUE)
# Genome-wide theta including ROH
theta_inc_roh <- read.table("gw_theta_inc_ROH.txt", header=TRUE)
theta_inc_roh
theta_o_roh
cbind(roh, theta_o_roh)
cbind(roh, theta_o_roh[,c("thetamid", "thetamin","thetamax")])
setwd("/Users/annamariacalderon/Desktop/KROH/data/rohan")
#Segments in ROH (%)
roh <- read.table("percent_ROH.txt", header=TRUE)
colnames(roh) <- c("sample", "fROH", "CI")
roh$sample <- as.character(roh$sample)
roh$pop <- c(rep("ckIWA",7), rep("hKIWA",6))
roh$sample <- factor(roh$sample,
levels = c("183194841","183195304","183195332",
"183195312","183195321","183194861",
"183195326","507264","29779",
"383194", "383202","383205","507265"))
# Genome-wide theta outside ROH
theta_o_roh <- read.table("gw_theta_outside_ROH.txt", header=TRUE)
# Genome-wide theta including ROH
theta_inc_roh <- read.table("gw_theta_inc_ROH.txt", header=TRUE)
#Combine Data
roh_theta <- cbind(roh, theta_o_roh[,c("thetamid", "thetamin","thetamax")])
ggplot(roh, aes(x=sample, y=fROH, fill=pop)) +
geom_bar(stat="identity") +
geom_point(roh, aes(x=sample, y=thetamid)) +
scale_fill_manual(values=c("gray","black")) +
scale_y_continuous(expand = c(0,0.2)) +
labs(x = NULL, y="Segments in ROH (%)") +
theme(panel.background = element_blank(),
panel.grid = element_blank(),
panel.border = element_rect(color="black", fill="NA"),
legend.background = element_blank(),
legend.title = element_blank(),
legend.position = "top",
axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5))
ggplot(roh, aes(x=sample, y=fROH, fill=pop)) +
geom_bar(stat="identity") +
geom_point(aes(y = thetamid), color = "red", size = 2) +
scale_fill_manual(values=c("gray","black")) +
scale_y_continuous(expand = c(0,0.2)) +
labs(x = NULL, y="Segments in ROH (%)") +
theme(panel.background = element_blank(),
panel.grid = element_blank(),
panel.border = element_rect(color="black", fill="NA"),
legend.background = element_blank(),
legend.title = element_blank(),
legend.position = "top",
axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5))
roh
setwd("/Users/annamariacalderon/Desktop/KROH/data/rohan")
#Segments in ROH (%)
roh <- read.table("percent_ROH.txt", header=TRUE)
colnames(roh) <- c("sample", "fROH", "CI")
roh$sample <- as.character(roh$sample)
roh$pop <- c(rep("ckIWA",7), rep("hKIWA",6))
roh$sample <- factor(roh$sample,
levels = c("183194841","183195304","183195332",
"183195312","183195321","183194861",
"183195326","507264","29779",
"383194", "383202","383205","507265"))
# Genome-wide theta outside ROH
theta_o_roh <- read.table("gw_theta_outside_ROH.txt", header=TRUE)
# Genome-wide theta including ROH
theta_inc_roh <- read.table("gw_theta_inc_ROH.txt", header=TRUE)
#Combine Data
roh_theta <- cbind(roh, theta_o_roh[,c("thetamid", "thetamin","thetamax")])
ggplot(roh_theta, aes(x=sample, y=fROH, fill=pop)) +
geom_bar(stat="identity") +
geom_point(aes(y = thetamid), color = "red", size = 2) +
scale_fill_manual(values=c("gray","black")) +
scale_y_continuous(expand = c(0,0.2)) +
labs(x = NULL, y="Segments in ROH (%)") +
theme(panel.background = element_blank(),
panel.grid = element_blank(),
panel.border = element_rect(color="black", fill="NA"),
legend.background = element_blank(),
legend.title = element_blank(),
legend.position = "top",
axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5))
ggplot(roh, aes(x = sample)) +
geom_bar(aes(y = fROH, fill = pop), stat = "identity") +
geom_point(aes(y = thetamid * scale_factor), color = "red", size = 2) +
scale_fill_manual(values = c("gray", "black")) +
scale_y_continuous(
name = "Segments in ROH (%)",
expand = c(0, 0.2),
sec.axis = sec_axis(~ . / scale_factor, name = expression(theta[outside~ROH]))
) +
labs(x = NULL) +
theme(
panel.background = element_blank(),
panel.grid = element_blank(),
panel.border = element_rect(color = "black", fill = NA),
legend.background = element_blank(),
legend.title = element_blank(),
legend.position = "top",
axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5)
)
ggplot(roh_theta, aes(x = sample)) +
geom_bar(aes(y = fROH, fill = pop), stat = "identity") +
geom_point(aes(y = thetamid * scale_factor), color = "red", size = 2) +
scale_fill_manual(values = c("gray", "black")) +
scale_y_continuous(
name = "Segments in ROH (%)",
expand = c(0, 0.2),
sec.axis = sec_axis(~ . / scale_factor, name = expression(theta[outside~ROH]))
) +
labs(x = NULL) +
theme(
panel.background = element_blank(),
panel.grid = element_blank(),
panel.border = element_rect(color = "black", fill = NA),
legend.background = element_blank(),
legend.title = element_blank(),
legend.position = "top",
axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5)
)
ggplot(roh_theta, aes(x=sample, y=fROH, fill=pop)) +
geom_bar(stat="identity") +
geom_point(aes(y = thetamid), color = "red", size = 2) +
sec.axis = sec_axis(~.) +
scale_fill_manual(values=c("gray","black")) +
scale_y_continuous(expand = c(0,0.2)) +
labs(x = NULL, y="Segments in ROH (%)") +
theme(panel.background = element_blank(),
panel.grid = element_blank(),
panel.border = element_rect(color="black", fill="NA"),
legend.background = element_blank(),
legend.title = element_blank(),
legend.position = "top",
axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5))
ggplot(roh_theta, aes(x=sample, y=fROH, fill=pop)) +
geom_bar(stat="identity") +
geom_point(aes(y = thetamid), color = "red", size = 2) +
sec.axis = sec_axis(~.) +
scale_fill_manual(values=c("gray","black")) +
scale_y_continuous(expand = c(0,0.2)) +
labs(x = NULL, y="Segments in ROH (%)") +
theme(panel.background = element_blank(),
panel.grid = element_blank(),
panel.border = element_rect(color="black", fill="NA"),
legend.background = element_blank(),
legend.title = element_blank(),
legend.position = "top",
axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5))
ggplot(roh_theta, aes(x=sample, y=fROH, fill=pop)) +
geom_bar(stat="identity") +
geom_point(aes(y = thetamid), color = "red", size = 2) +
sec.axis = sec_axis(~.thetamid) +
scale_fill_manual(values=c("gray","black")) +
scale_y_continuous(expand = c(0,0.2)) +
labs(x = NULL, y="Segments in ROH (%)") +
theme(panel.background = element_blank(),
panel.grid = element_blank(),
panel.border = element_rect(color="black", fill="NA"),
legend.background = element_blank(),
legend.title = element_blank(),
legend.position = "top",
axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5))
ggplot(roh_theta, aes(x=sample, y=fROH, fill=pop)) +
geom_bar(stat="identity") +
geom_point(aes(y = thetamid * scale_factor), color = "red", size = 2) +  # rescale to match fROH range
scale_fill_manual(values = c("gray","black")) +
scale_y_continuous(
name = "Segments in ROH (%)",
expand = c(0,0.2),
sec.axis = sec_axis(~./scale_factor, name = expression(theta))
) +
labs(x = NULL) +
theme(
panel.background = element_blank(),
panel.grid = element_blank(),
panel.border = element_rect(color="black", fill=NA),
legend.background = element_blank(),
legend.title = element_blank(),
legend.position = "top",
axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5)
)
roh_theta
ggplot(roh_theta, aes(x=sample, y=fROH, fill=pop)) +
geom_bar(stat="identity") +
geom_point(aes(y = thetamid*1000), color = "red", size = 2) +
sec.axis = sec_axis(~.thetamid) +
scale_fill_manual(values=c("gray","black")) +
scale_y_continuous(expand = c(0,0.2)) +
labs(x = NULL, y="Segments in ROH (%)") +
theme(panel.background = element_blank(),
panel.grid = element_blank(),
panel.border = element_rect(color="black", fill="NA"),
legend.background = element_blank(),
legend.title = element_blank(),
legend.position = "top",
axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5))
{r plot, include=FALSE}
ggplot(roh_theta, aes(x=sample, y=fROH, fill=pop)) +
geom_bar(stat="identity") +
geom_point(aes(y = thetamid*1000), color = "red", size = 2) +
scale_fill_manual(values=c("gray","black")) +
scale_y_continuous(expand = c(0,0.2)) +
labs(x = NULL, y="Segments in ROH (%)") +
theme(panel.background = element_blank(),
panel.grid = element_blank(),
panel.border = element_rect(color="black", fill="NA"),
legend.background = element_blank(),
legend.title = element_blank(),
legend.position = "top",
axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5))
ggplot(roh_theta, aes(x=sample, y=fROH, fill=pop)) +
geom_bar(stat="identity") +
geom_point(aes(y = thetamid*10000), color = "red", size = 2) +
scale_fill_manual(values=c("gray","black")) +
scale_y_continuous(expand = c(0,0.2)) +
labs(x = NULL, y="Segments in ROH (%)") +
theme(panel.background = element_blank(),
panel.grid = element_blank(),
panel.border = element_rect(color="black", fill="NA"),
legend.background = element_blank(),
legend.title = element_blank(),
legend.position = "top",
axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5))
ggplot(roh_theta, aes(x=sample, y=fROH, fill=pop)) +
geom_bar(stat="identity") +
geom_point(aes(y = thetamid*5000), color = "red", size = 2) +
scale_fill_manual(values=c("gray","black")) +
scale_y_continuous(expand = c(0,0.2)) +
labs(x = NULL, y="Segments in ROH (%)") +
theme(panel.background = element_blank(),
panel.grid = element_blank(),
panel.border = element_rect(color="black", fill="NA"),
legend.background = element_blank(),
legend.title = element_blank(),
legend.position = "top",
axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5))
ggplot(roh_theta, aes(x=sample, y=fROH, fill=pop)) +
geom_bar(stat="identity") +
geom_point(aes(y = thetamid*5000), color = "red", size = 2) +
scale_fill_manual(values=c("gray","black")) +
scale_y_continuous(expand = c(0,0.2),
name = "X",
sec.axis = sec_axis(~./5000, name="X")) +
labs(x = NULL, y="Segments in ROH (%)") +
theme(panel.background = element_blank(),
panel.grid = element_blank(),
panel.border = element_rect(color="black", fill="NA"),
legend.background = element_blank(),
legend.title = element_blank(),
legend.position = "top",
axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5))
ggplot(roh_theta, aes(x=sample, y=fROH, fill=pop)) +
geom_bar(stat="identity") +
geom_point(aes(y = thetamid*5000), color = "red", size = 2) +
scale_fill_manual(values=c("gray","black")) +
scale_y_continuous(expand = c(0,0.2),
name = "Segments in ROH (%)",
sec.axis = sec_axis(~./5000, name="X")) +
labs(x = NULL) +
theme(panel.background = element_blank(),
panel.grid = element_blank(),
panel.border = element_rect(color="black", fill="NA"),
legend.background = element_blank(),
legend.title = element_blank(),
legend.position = "top",
axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5))
ggplot(roh_theta, aes(x=sample, y=fROH, fill=pop)) +
geom_bar(stat="identity") +
geom_point(aes(y = thetamid*5000), color = "red", size = 2) +
scale_fill_manual(values=c("gray","black")) +
scale_y_continuous(expand = c(0,0.2),
name = "Segments in ROH (%)",
sec.axis = sec_axis(~./5000, name="Genome-wide theta outside ROH")) +
labs(x = NULL) +
theme(panel.background = element_blank(),
panel.grid = element_blank(),
panel.border = element_rect(color="black", fill="NA"),
legend.background = element_blank(),
legend.title = element_blank(),
legend.position = "top",
axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5))
ggplot(roh_theta, aes(x=sample, y=fROH, fill=pop)) +
geom_bar(stat="identity") +
geom_point(aes(y = thetamid * 5000), color = "red", size = 2) +
scale_fill_manual(values=c("gray","black")) +
scale_y_continuous(
name = "Segments in ROH (%)",
expand = c(0,0.2),
sec.axis = sec_axis(~./5000, name = expression("Genome-wide " * theta))
) +
labs(x = NULL) +
theme(
panel.background = element_blank(),
panel.grid = element_blank(),
panel.border = element_rect(color = "black", fill = NA),
legend.background = element_blank(),
legend.title = element_blank(),
legend.position = "top",
axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5)
)
ggplot(roh_theta, aes(x=sample, y=fROH, fill=pop)) +
geom_bar(stat="identity") +
geom_point(aes(y = thetamid * 5000), color = "red", size = 2) +
scale_fill_manual(values=c("gray","black")) +
scale_y_continuous(
name = "Segments in ROH (%)",
expand = c(0,0.2),
sec.axis = sec_axis(~./5000,
name = expression("Genome-wide " * theta))) +
geom_errorbar(aes(y=thetamid*5000, ymin=thetamin*5000, ymax=thetamax*5000),
color = "red",
width = 0.3) +
labs(x = NULL) +
theme(
panel.background = element_blank(),
panel.grid = element_blank(),
panel.border = element_rect(color = "black", fill = NA),
legend.background = element_blank(),
legend.title = element_blank(),
legend.position = "top",
axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5)
)
ggplot(roh_theta, aes(x=sample, y=fROH, fill=pop)) +
geom_bar(stat="identity") +
geom_point(aes(y = thetamid * 5000), color = "red", size = 2) +
scale_fill_manual(values=c("gray","black")) +
scale_y_continuous(
name = "Segments in ROH (%)",
expand = c(0,0.2),
sec.axis = sec_axis(~./5000,
name = expression("Genome-wide " * theta))) +
geom_errorbar(aes(y=thetamid*5000, ymin=thetamin*5000, ymax=thetamax*5000),
color = "red",
width = 0.3) +
labs(x = NULL) +
theme(
panel.background = element_blank(),
panel.grid = element_blank(),
panel.border = element_rect(color = "black", fill = NA),
legend.background = element_blank(),
legend.title = element_blank(),
legend.position = "top",
axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5)
)
ggplot(roh_theta, aes(x=sample, y=fROH, fill=pop)) +
geom_bar(stat="identity") +
geom_point(aes(y = thetamid * 5000),
color = "red",
size = 2,
show.legend = FALSE) +
scale_fill_manual(values=c("gray","black")) +
scale_y_continuous(
name = "Segments in ROH (%)",
expand = c(0,0.2),
sec.axis = sec_axis(~./5000,
name = expression("Genome-wide " * theta))) +
geom_errorbar(aes(y=thetamid*5000, ymin=thetamin*5000, ymax=thetamax*5000),
color = "red",
width = 0.3) +
labs(x = NULL) +
theme(
panel.background = element_blank(),
panel.grid = element_blank(),
panel.border = element_rect(color = "black", fill = NA),
legend.background = element_blank(),
legend.title = element_blank(),
legend.position = "top",
axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5)
)
ggplot(roh_theta, aes(x=sample, y=fROH, fill=pop)) +
geom_bar(stat="identity") +
geom_point(aes(y = thetamid * 5000),
color = "red",
size = 2,
show.legend = FALSE) +
scale_fill_manual(values=c("gray","black")) +
scale_y_continuous(
name = "Segments in ROH (%)",
expand = c(0,0.2),
sec.axis = sec_axis(~./5000,
name = expression("Genome-wide " * theta))) +
geom_errorbar(aes(y=thetamid*5000, ymin=thetamin*5000, ymax=thetamax*5000),
color = "red",
width = 0.3) +
labs(x = NULL) +
theme(
panel.background = element_blank(),
panel.grid = element_blank(),
panel.border = element_rect(color = "black", fill = NA),
legend.background = element_blank(),
legend.title = element_blank(),
legend.position = "top",
axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5)
)
theta_inc_roh
ggplot(roh_theta, aes(x=sample, y=fROH, fill=pop)) +
geom_bar(stat="identity") +
geom_point(aes(y = thetamid * 5000),
color = "red",
size = 2,
show.legend = FALSE) +
geom_point(aes(y = mid * 5000),
color = "blue",
size = 2,
show.legend = FALSE) +
scale_fill_manual(values=c("gray","black")) +
scale_y_continuous(
name = "Segments in ROH (%)",
expand = c(0,0.2),
sec.axis = sec_axis(~./5000,
name = expression("Genome-wide " * theta))) +
geom_errorbar(aes(y=thetamid*5000, ymin=thetamin*5000, ymax=thetamax*5000),
color = "red",
width = 0.3) +
geom_errorbar(aes(y=mid*5000, ymin=min*5000, ymax=max*5000),
color = "blue",
width = 0.3) +
labs(x = NULL) +
theme(
panel.background = element_blank(),
panel.grid = element_blank(),
panel.border = element_rect(color = "black", fill = NA),
legend.background = element_blank(),
legend.title = element_blank(),
legend.position = "top",
axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5)
)
setwd("/Users/annamariacalderon/Desktop/KROH/data/rohan")
#Segments in ROH (%)
roh <- read.table("percent_ROH.txt", header=TRUE)
colnames(roh) <- c("sample", "fROH", "CI")
roh$sample <- as.character(roh$sample)
roh$pop <- c(rep("ckIWA",7), rep("hKIWA",6))
roh$sample <- factor(roh$sample,
levels = c("183194841","183195304","183195332",
"183195312","183195321","183194861",
"183195326","507264","29779",
"383194", "383202","383205","507265"))
# Genome-wide theta outside ROH
theta_o_roh <- read.table("gw_theta_outside_ROH.txt", header=TRUE)
# Genome-wide theta including ROH
theta_inc_roh <- read.table("gw_theta_inc_ROH.txt", header=TRUE)
colnames(theta_inc_roh) <- c("sample","mid","min","max")
#Combine Data
roh_theta <- cbind(roh,
theta_o_roh[,c("thetamid", "thetamin","thetamax")],
theta_inc_roh[,c("mid", "min","max")])
ggplot(roh_theta, aes(x=sample, y=fROH, fill=pop)) +
geom_bar(stat="identity") +
geom_point(aes(y = thetamid * 5000),
color = "red",
size = 2,
show.legend = FALSE) +
geom_point(aes(y = mid * 5000),
color = "blue",
size = 2,
show.legend = FALSE) +
scale_fill_manual(values=c("gray","black")) +
scale_y_continuous(
name = "Segments in ROH (%)",
expand = c(0,0.2),
sec.axis = sec_axis(~./5000,
name = expression("Genome-wide " * theta))) +
geom_errorbar(aes(y=thetamid*5000, ymin=thetamin*5000, ymax=thetamax*5000),
color = "red",
width = 0.3) +
geom_errorbar(aes(y=mid*5000, ymin=min*5000, ymax=max*5000),
color = "blue",
width = 0.3) +
labs(x = NULL) +
theme(
panel.background = element_blank(),
panel.grid = element_blank(),
panel.border = element_rect(color = "black", fill = NA),
legend.background = element_blank(),
legend.title = element_blank(),
legend.position = "top",
axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5)
)
ggplot(roh_theta, aes(x=sample, y=fROH, fill=pop)) +
geom_bar(stat="identity") +
geom_point(aes(y = thetamid * 5000),
color = "red",
size = 2,
show.legend = FALSE) +
geom_point(aes(y = mid * 5000),
color = "blue",
size = 2,
show.legend = FALSE) +
scale_fill_manual(values=c("gray","black")) +
scale_y_continuous(
name = "Segments in ROH (%)",
expand = c(0,0.2),
sec.axis = sec_axis(~./5000,
name = expression("Genome-wide " * theta))) +
geom_errorbar(aes(y=thetamid*5000, ymin=thetamin*5000, ymax=thetamax*5000),
color = "red",
width = 0.3) +
geom_errorbar(aes(y=mid*5000, ymin=min*5000, ymax=max*5000),
color = "blue",
width = 0.3) +
labs(x = NULL) +
theme(
panel.background = element_blank(),
panel.grid = element_blank(),
panel.border = element_rect(color = "black", fill = NA),
legend.background = element_blank(),
legend.title = element_blank(),
legend.position = "top",
axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5)
)
