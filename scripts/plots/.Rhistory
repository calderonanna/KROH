"noncoding"      = "black"   # bright yellow (fun)
)
ggplot(rab, aes(y=NUM, fill=MUT, alpha=NEUTRAL)) +
geom_rect(aes(xmin=1, xmax=AVG, ymin=NUM-0.5, ymax=NUM+0.5),
color="black") +
geom_point(aes(x=RAB, y=NUM),size = 1) +
scale_alpha_manual(values=c(1,0.5), name=NULL) +
scale_fill_manual(values = colors, guide="none") +
geom_errorbarh(aes(xmin = Q25, xmax = Q97, y = NUM), height = 0.2) +
scale_x_continuous(limits=c(0,1.5), breaks=seq(0,1.5,0.2)) +
scale_y_continuous(
breaks = c(1.5,4.5,7.5,10.5,13.5,16.5),
labels = unique(rab$MUT)) +
geom_vline(xintercept = 1.0, color="black") +
theme(
panel.background = element_blank(),
panel.grid.minor.x = element_line(linetype="dashed", color="black", linewidth=.05),
panel.border = element_rect(color="black", fill=NA),
axis.title.y = element_blank(),
axis.text.x = element_text(size=8, color="black"),
axis.text.y = element_text(size=8, color="black")) +
xlab("RAB")
olors <- c(
"synonymous"     = "#85FFC2",  # teal blue (cool)
"nonsynonymous"  = "#FFC285",  # bright red (warm)
"tolerated"      = "#85C2FF",  # cyan (cool)
"deleterious"    = "#FF85C2",  # orange (warm)
"lossoffunction" = "#FF8585",  # vivid purple (fun)
"noncoding"      = "black"   # bright yellow (fun)
)
ggplot(rab, aes(y=NUM, fill=MUT, alpha=NEUTRAL)) +
geom_rect(aes(xmin=1, xmax=AVG, ymin=NUM-0.5, ymax=NUM+0.5),
color="black") +
geom_point(aes(x=RAB, y=NUM),size = 1) +
scale_alpha_manual(values=c(1,0.5), name=NULL) +
scale_fill_manual(values = colors, guide="none") +
geom_errorbarh(aes(xmin = Q25, xmax = Q97, y = NUM), height = 0.2) +
scale_x_continuous(limits=c(0,1.5), breaks=seq(0,1.5,0.2)) +
scale_y_continuous(
breaks = c(1.5,4.5,7.5,10.5,13.5,16.5),
labels = unique(rab$MUT)) +
geom_vline(xintercept = 1.0, color="black") +
theme(
panel.background = element_blank(),
panel.grid.minor.x = element_line(linetype="dashed", color="black", linewidth=.05),
panel.border = element_rect(color="black", fill=NA),
axis.title.y = element_blank(),
axis.text.x = element_text(size=8, color="black"),
axis.text.y = element_text(size=8, color="black")) +
xlab("RAB")
colors <- c(
"synonymous"     = "#85FFC2",  # teal blue (cool)
"nonsynonymous"  = "#FFC285",  # bright red (warm)
"tolerated"      = "#85C2FF",  # cyan (cool)
"deleterious"    = "#FF85C2",  # orange (warm)
"lossoffunction" = "#FF8585",  # vivid purple (fun)
"noncoding"      = "black"   # bright yellow (fun)
)
ggplot(rab, aes(y=NUM, fill=MUT, alpha=NEUTRAL)) +
geom_rect(aes(xmin=1, xmax=AVG, ymin=NUM-0.5, ymax=NUM+0.5),
color="black") +
geom_point(aes(x=RAB, y=NUM),size = 1) +
scale_alpha_manual(values=c(1,0.5), name=NULL) +
scale_fill_manual(values = colors, guide="none") +
geom_errorbarh(aes(xmin = Q25, xmax = Q97, y = NUM), height = 0.2) +
scale_x_continuous(limits=c(0,1.5), breaks=seq(0,1.5,0.2)) +
scale_y_continuous(
breaks = c(1.5,4.5,7.5,10.5,13.5,16.5),
labels = unique(rab$MUT)) +
geom_vline(xintercept = 1.0, color="black") +
theme(
panel.background = element_blank(),
panel.grid.minor.x = element_line(linetype="dashed", color="black", linewidth=.05),
panel.border = element_rect(color="black", fill=NA),
axis.title.y = element_blank(),
axis.text.x = element_text(size=8, color="black"),
axis.text.y = element_text(size=8, color="black")) +
xlab("RAB")
colors <- c(
"synonymous"     = "#85FFC2",  # teal blue (cool)
"nonsynonymous"  = "#FFC803",  # bright red (warm)
"tolerated"      = "#85C2FF",  # cyan (cool)
"deleterious"    = "#FF85C2",  # orange (warm)
"lossoffunction" = "#9D57FF",  # vivid purple (fun)
"noncoding"      = "black"   # bright yellow (fun)
)
ggplot(rab, aes(y=NUM, fill=MUT, alpha=NEUTRAL)) +
geom_rect(aes(xmin=1, xmax=AVG, ymin=NUM-0.5, ymax=NUM+0.5),
color="black") +
geom_point(aes(x=RAB, y=NUM),size = 1) +
scale_alpha_manual(values=c(1,0.5), name=NULL) +
scale_fill_manual(values = colors, guide="none") +
geom_errorbarh(aes(xmin = Q25, xmax = Q97, y = NUM), height = 0.2) +
scale_x_continuous(limits=c(0,1.5), breaks=seq(0,1.5,0.2)) +
scale_y_continuous(
breaks = c(1.5,4.5,7.5,10.5,13.5,16.5),
labels = unique(rab$MUT)) +
geom_vline(xintercept = 1.0, color="black") +
theme(
panel.background = element_blank(),
panel.grid.minor.x = element_line(linetype="dashed", color="black", linewidth=.05),
panel.border = element_rect(color="black", fill=NA),
axis.title.y = element_blank(),
axis.text.x = element_text(size=8, color="black"),
axis.text.y = element_text(size=8, color="black")) +
xlab("RAB")
colors <- c(
"synonymous"     = "#85FFC2",  # teal blue (cool)
"nonsynonymous"  = "#FFC803",  # bright red (warm)
"tolerated"      = "#00DEFF",  # cyan (cool)
"deleterious"    = "#FF698E",  # orange (warm)
"lossoffunction" = "#9D57FF",  # vivid purple (fun)
"noncoding"      = "black"   # bright yellow (fun)
)
ggplot(rab, aes(y=NUM, fill=MUT, alpha=NEUTRAL)) +
geom_rect(aes(xmin=1, xmax=AVG, ymin=NUM-0.5, ymax=NUM+0.5),
color="black") +
geom_point(aes(x=RAB, y=NUM),size = 1) +
scale_alpha_manual(values=c(1,0.5), name=NULL) +
scale_fill_manual(values = colors, guide="none") +
geom_errorbarh(aes(xmin = Q25, xmax = Q97, y = NUM), height = 0.2) +
scale_x_continuous(limits=c(0,1.5), breaks=seq(0,1.5,0.2)) +
scale_y_continuous(
breaks = c(1.5,4.5,7.5,10.5,13.5,16.5),
labels = unique(rab$MUT)) +
geom_vline(xintercept = 1.0, color="black") +
theme(
panel.background = element_blank(),
panel.grid.minor.x = element_line(linetype="dashed", color="black", linewidth=.05),
panel.border = element_rect(color="black", fill=NA),
axis.title.y = element_blank(),
axis.text.x = element_text(size=8, color="black"),
axis.text.y = element_text(size=8, color="black")) +
xlab("RAB")
ggplot(rab, aes(y=NUM, fill=MUT, alpha=NEUTRAL)) +
geom_rect(aes(xmin=1, xmax=AVG, ymin=NUM-0.4, ymax=NUM+0.4),
color="black") +
geom_point(aes(x=RAB, y=NUM),size = 1) +
scale_alpha_manual(values=c(1,0.5), name=NULL) +
scale_fill_manual(values = colors, guide="none") +
geom_errorbarh(aes(xmin = Q25, xmax = Q97, y = NUM), height = 0.2) +
scale_x_continuous(limits=c(0,1.5), breaks=seq(0,1.5,0.2)) +
scale_y_continuous(
breaks = c(1.5,4.5,7.5,10.5,13.5,16.5),
labels = unique(rab$MUT)) +
geom_vline(xintercept = 1.0, color="black") +
theme(
panel.background = element_blank(),
panel.grid.minor.x = element_line(linetype="dashed", color="black", linewidth=.05),
panel.border = element_rect(color="black", fill=NA),
axis.title.y = element_blank(),
axis.text.x = element_text(size=8, color="black"),
axis.text.y = element_text(size=8, color="black")) +
xlab("RAB")
colors <- c(
"synonymous"     = "#54FFFC",  # teal blue (cool)
"nonsynonymous"  = "#FFFC54",  # bright red (warm)
"tolerated"      = "#5457FF",  # cyan (cool)
"deleterious"    = "#FFA654",  # orange (warm)
"lossoffunction" = "#FF5457",  # vivid purple (fun)
"noncoding"      = "black"   # bright yellow (fun)
)
colors <- c(
"synonymous"     = "#A0D984",  # teal blue (cool)
"nonsynonymous"  = "#FFC803",  # bright red (warm)
"tolerated"      = "#00DEFF",  # cyan (cool)
"deleterious"    = "#FF698E",  # orange (warm)
"lossoffunction" = "#A600D4",  # vivid purple (fun)
"noncoding"      = "black"   # bright yellow (fun)
)
ggplot(rab, aes(y=NUM, fill=MUT, alpha=NEUTRAL)) +
geom_rect(aes(xmin=1, xmax=AVG, ymin=NUM-0.4, ymax=NUM+0.4),
color="black") +
geom_point(aes(x=RAB, y=NUM),size = 1) +
scale_alpha_manual(values=c(1,0.5), name=NULL) +
scale_fill_manual(values = colors, guide="none") +
geom_errorbarh(aes(xmin = Q25, xmax = Q97, y = NUM), height = 0.2) +
scale_x_continuous(limits=c(0,1.5), breaks=seq(0,1.5,0.2)) +
scale_y_continuous(
breaks = c(1.5,4.5,7.5,10.5,13.5,16.5),
labels = unique(rab$MUT)) +
geom_vline(xintercept = 1.0, color="black") +
theme(
panel.background = element_blank(),
panel.grid.minor.x = element_line(linetype="dashed", color="black", linewidth=.05),
panel.border = element_rect(color="black", fill=NA),
axis.title.y = element_blank(),
axis.text.x = element_text(size=8, color="black"),
axis.text.y = element_text(size=8, color="black")) +
xlab("RAB")
colors <- c(
"synonymous"     = "#A0D984",  # teal blue (cool)
"nonsynonymous"  = "#FFC803",  # bright red (warm)
"tolerated"      = "#00DEFF",  # cyan (cool)
"deleterious"    = "#FF4F69",  # orange (warm)
"lossoffunction" = "#A600D4",  # vivid purple (fun)
"noncoding"      = "black"   # bright yellow (fun)
)
ggplot(rab, aes(y=NUM, fill=MUT, alpha=NEUTRAL)) +
geom_rect(aes(xmin=1, xmax=AVG, ymin=NUM-0.4, ymax=NUM+0.4),
color="black") +
geom_point(aes(x=RAB, y=NUM),size = 1) +
scale_alpha_manual(values=c(1,0.5), name=NULL) +
scale_fill_manual(values = colors, guide="none") +
geom_errorbarh(aes(xmin = Q25, xmax = Q97, y = NUM), height = 0.2) +
scale_x_continuous(limits=c(0,1.5), breaks=seq(0,1.5,0.2)) +
scale_y_continuous(
breaks = c(1.5,4.5,7.5,10.5,13.5,16.5),
labels = unique(rab$MUT)) +
geom_vline(xintercept = 1.0, color="black") +
theme(
panel.background = element_blank(),
panel.grid.minor.x = element_line(linetype="dashed", color="black", linewidth=.05),
panel.border = element_rect(color="black", fill=NA),
axis.title.y = element_blank(),
axis.text.x = element_text(size=8, color="black"),
axis.text.y = element_text(size=8, color="black")) +
xlab("RAB")
rab <- rbind(
subset(df, df$MUT=="lossoffunction"),
subset(df, df$MUT=="deleterious"),
subset(df, df$MUT=="nonsynonymous"),
subset(df, df$MUT=="tolerated")
subset(df, df$MUT=="synonymous")
knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)
library(ggpubr)
library(tidyr)
library(dplyr)
library(reshape2)
setwd("/Users/abc6435/Desktop/KROH/data/rab")
df <- read.table("results.txt", header = TRUE)
rab <- rbind(
subset(df, df$MUT=="lossoffunction"),
subset(df, df$MUT=="deleterious"),
subset(df, df$MUT=="nonsynonymous"),
subset(df, df$MUT=="tolerated")
subset(df, df$MUT=="synonymous")
rab <- rbind(
subset(df, df$MUT=="lossoffunction"),
subset(df, df$MUT=="deleterious"),
subset(df, df$MUT=="nonsynonymous"),
subset(df, df$MUT=="tolerated"),
subset(df, df$MUT=="synonymous"),
subset(df, df$MUT=="noncoding"))
rownames(rab) <- NULL
rab$NUM <- c(1,2,4,5,7,8,10,11,13,14,16,17)
rab
colors = c(
"lossoffunction"="#FF12B4",
"deleterious"="#C870E0",
"nonsynonymous"="#7083E0",
"tolerated"="#70E0CA",
"synonymous"="#C1E070",
"noncoding"="#FFD400"
)
ggplot(rab, aes(y=NUM, fill=MUT, alpha=NEUTRAL)) +
geom_rect(aes(xmin=1, xmax=AVG, ymin=NUM-0.4, ymax=NUM+0.4),
color="black") +
geom_point(aes(x=RAB, y=NUM),size = 1) +
scale_alpha_manual(values=c(1,0.5), name=NULL) +
scale_fill_manual(values = colors, guide="none") +
geom_errorbarh(aes(xmin = Q25, xmax = Q97, y = NUM), height = 0.2) +
scale_x_continuous(limits=c(0,1.5), breaks=seq(0,1.5,0.2)) +
scale_y_continuous(
breaks = c(1.5,4.5,7.5,10.5,13.5,16.5),
labels = unique(rab$MUT)) +
geom_vline(xintercept = 1.0, color="black") +
theme(
panel.background = element_blank(),
panel.grid.minor.x = element_line(linetype="dashed", color="black", linewidth=.05),
panel.border = element_rect(color="black", fill=NA),
axis.title.y = element_blank(),
axis.text.x = element_text(size=8, color="black"),
axis.text.y = element_text(size=8, color="black")) +
xlab("RAB")
ggplot(rab, aes(y=NUM, fill=MUT, alpha=NEUTRAL)) +
geom_rect(aes(xmin=1, xmax=AVG, ymin=NUM-0.4, ymax=NUM+0.4),
color="black") +
geom_point(aes(x=RAB, y=NUM),size = 1) +
scale_alpha_manual(values=c(1,0.5), name=NULL) +
scale_fill_manual(values = colors, guide="none") +
geom_errorbarh(aes(xmin = Q25, xmax = Q97, y = NUM), height = 0.2) +
scale_x_continuous(limits=c(0,1.5), breaks=seq(0,1.5,0.2)) +
scale_y_continuous(
breaks = c(1.5,4.5,7.5,10.5,13.5,16.5),
labels = unique(rab$MUT)) +
geom_vline(xintercept = 1.0, color="black") +
theme(
panel.background = element_blank(),
panel.grid.minor.x = element_line(linetype="dashed", color="black", linewidth=.05),
panel.border = element_rect(color="black", fill=NA),
axis.title.y = element_blank(),
axis.text.x = element_text(size=8, color="black"),
axis.text.y = element_text(size=8, color="black"),
legend.position = "bottom") +
xlab("RAB")
ggsave("rab.png", plot=rab_plot,
path ="~/Desktop/KROH/figures",
width = 3, height = 4, units = "in", dpi = 300)
colors = c(
"lossoffunction"="#FF12B4",
"deleterious"="#C870E0",
"nonsynonymous"="#7083E0",
"tolerated"="#70E0CA",
"synonymous"="#C1E070",
"noncoding"="#FFD400"
)
rab_plot <- ggplot(rab, aes(y=NUM, fill=MUT, alpha=NEUTRAL)) +
geom_rect(aes(xmin=1, xmax=AVG, ymin=NUM-0.4, ymax=NUM+0.4),
color="black") +
geom_point(aes(x=RAB, y=NUM),size = 1) +
scale_alpha_manual(values=c(1,0.5), name=NULL) +
scale_fill_manual(values = colors, guide="none") +
geom_errorbarh(aes(xmin = Q25, xmax = Q97, y = NUM), height = 0.2) +
scale_x_continuous(limits=c(0,1.5), breaks=seq(0,1.5,0.2)) +
scale_y_continuous(
breaks = c(1.5,4.5,7.5,10.5,13.5,16.5),
labels = unique(rab$MUT)) +
geom_vline(xintercept = 1.0, color="black") +
theme(
panel.background = element_blank(),
panel.grid.minor.x = element_line(linetype="dashed", color="black", linewidth=.05),
panel.border = element_rect(color="black", fill=NA),
axis.title.y = element_blank(),
axis.text.x = element_text(size=8, color="black"),
axis.text.y = element_text(size=8, color="black"),
legend.position = "bottom") +
xlab("RAB")
ggsave("rab.png", plot=rab_plot,
path ="~/Desktop/KROH/figures",
width = 3, height = 4, units = "in", dpi = 300)
ggsave("rab.png", plot=rab_plot,
path ="~/Desktop/KROH/figures",
width = 4, height = 4, units = "in", dpi = 300)
ggsave("rab.png", plot=rab_plot,
path ="~/Desktop/KROH/figures",
width = 4, height = 3, units = "in", dpi = 300)
ggsave("rab.png", plot=rab_plot,
path ="~/Desktop/KROH/figures",
width = 4, height = 5, units = "in", dpi = 300)
ggsave("rab.png", plot=rab_plot,
path ="~/Desktop/KROH/figures",
width = 4, height = 4.5, units = "in", dpi = 300)
knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)
library(ggpubr)
library(tidyr)
library(dplyr)
setwd("~/Desktop/KROH/data/slim/rxy")
rxy <- read.table("rxy.txt",
header = FALSE,
na.strings = c("nan", "NaN", "NA", "."))
rxy <- na.omit(rxy)
colnames(rxy) <- c("rxy", "q025", "q975", "s", "h","rep")
rownames(rxy) <- NULL
rxy$rxy_y <- as.numeric(rownames(rxy))
rxy$h <- factor(rxy$h, levels = c("h00","h05","h10"))
P1=c("#1AABFF","#FFE01A","#FF1A39")
P2=c("#8FD3FF","#FFF48F","#FF8F9A")
rxy_slim <-
ggplot(rxy[rxy$rxy<2,], aes(x=rxy, y=s, fill=h)) +
geom_violin(alpha=0.5, color="black", width=1.0) +
geom_boxplot(width=0.05, color="black", outlier.shape = NA) +
geom_jitter(shape = 16, height = 0.05, size=0.3, alpha=0.3) +
scale_fill_manual(values = P1) +
geom_vline(xintercept = 1.0,
color="black",
linetype="dashed",
linewidth=0.15) +
facet_wrap(~h, ncol=3, scales="free_x") +
xlab("RAB") +
theme(
panel.background = element_blank(),
panel.border = element_rect(fill=NA, color="black"),
legend.position="none",
strip.text = element_text(color="white"),
strip.background = element_rect(fill="black", color=NA),
axis.text = element_text(color="black")
)
ggsave(filename = "rab_slim.png",
plot = rxy_slim,
width = 6,
height = 6,
units = "in",
dpi = 300,
path = "~/Desktop/KROH/figures/")
P1=c("#1AABFF","#FFE01A","#FF1A39")
P2=c("#8FD3FF","#FFF48F","#FF8F9A")
rxy_slim <-
ggplot(rxy[rxy$rxy<2,], aes(x=rxy, y=s, fill=h)) +
geom_violin(alpha=0.5, color="black", width=1.0) +
geom_boxplot(width=0.05, color="black", outlier.shape = NA) +
geom_jitter(shape = 16, height = 0.05, size=0.3, alpha=0.3) +
scale_fill_manual(values = P1) +
geom_vline(xintercept = 1.0,
color="black",
linetype="dashed",
linewidth=0.15) +
facet_wrap(~h, ncol=3, scales="free_x") +
xlab("RAB") +
theme(
panel.background = element_blank(),
panel.border = element_rect(fill=NA, color="black"),
legend.position="none",
strip.text = element_text(color="white"),
strip.background = element_rect(fill="black", color=NA),
axis.text = element_text(color="black")
)
rxy_slim
ggsave(filename = "rab_slim.png",
plot = rxy_slim,
width = 6,
height = 6,
units = "in",
dpi = 300,
path = "~/Desktop/KROH/figures/")
ggsave(filename = "rab_slim.png",
plot = rxy_slim,
width = 6,
height = 6,
units = "in",
dpi = 300,
path = "~/Desktop/KROH/figures")
rxy_slim
ggsave(filename = "rab_slim.png",
plot = rxy_slim,
width = 6,
height = 6,
units = "in",
dpi = 300,
path = "~/Desktop/KROH/figures")
P1=c("#1AABFF","#FFE01A","#FF1A39")
P2=c("#8FD3FF","#FFF48F","#FF8F9A")
rxy_slim <-
ggplot(rxy[rxy$rxy<2,], aes(x=rxy, y=s, fill=h)) +
geom_violin(alpha=0.5, color="black", width=1.0) +
geom_boxplot(width=0.05, color="black", outlier.shape = NA) +
geom_jitter(shape = 16, height = 0.05, size=0.3, alpha=0.3) +
scale_fill_manual(values = P1) +
geom_vline(xintercept = 1.0,
color="black",
linetype="dashed",
linewidth=0.15) +
facet_wrap(~h, ncol=3, scales="free_x") +
xlab("RAB") +
theme(
panel.background = element_blank(),
panel.border = element_rect(fill=NA, color="black"),
legend.position="none",
strip.text = element_text(color="white"),
strip.background = element_rect(fill="black", color=NA),
axis.text = element_text(color="black")
)
P1=c("#1AABFF","#FFE01A","#FF1A39")
P2=c("#8FD3FF","#FFF48F","#FF8F9A")
rxy_slim <-
ggplot(rxy[rxy$rxy<2,], aes(x=rxy, y=s, fill=h)) +
geom_violin(alpha=0.5, color="black", width=1.0) +
geom_boxplot(width=0.05, color="black", outlier.shape = NA) +
geom_jitter(shape = 16, height = 0.05, size=0.3, alpha=0.3) +
scale_fill_manual(values = P1) +
geom_vline(xintercept = 1.0,
color="black",
linetype="dashed",
linewidth=0.15) +
facet_wrap(~h, ncol=3, scales="free_x") +
xlab("RAB") +
theme(
panel.background = element_blank(),
panel.border = element_rect(fill=NA, color="black"),
legend.position="none",
strip.text = element_text(color="white"),
strip.background = element_rect(fill="black", color=NA),
axis.text = element_text(color="black")
)
P1=c("#1AABFF","#FFE01A","#FF1A39")
P2=c("#8FD3FF","#FFF48F","#FF8F9A")
rxy_slim <-
ggplot(rxy[rxy$rxy<2,], aes(x=rxy, y=s, fill=h)) +
geom_violin(alpha=0.5, color="black", width=1.0) +
geom_boxplot(width=0.05, color="black", outlier.shape = NA) +
geom_jitter(shape = 16, height = 0.05, size=0.3, alpha=0.3) +
scale_fill_manual(values = P1) +
geom_vline(xintercept = 1.0,
color="black",
linetype="dashed",
linewidth=0.15) +
facet_wrap(~h, ncol=3, scales="free_x") +
xlab("RAB") +
theme(
panel.background = element_blank(),
panel.border = element_rect(fill=NA, color="black"),
legend.position="none",
strip.text = element_text(color="white"),
strip.background = element_rect(fill="black", color=NA),
axis.text = element_text(color="black")
)
ggsave(filename = "rab_slim.png",
plot = rxy_slim,
width = 6,
height = 6,
units = "in",
dpi = 300,
path = "~/Desktop/KROH/figures")
ggsave(filename = "rab_slim_plot.png",
plot = rxy_slim,
width = 6,
height = 6,
units = "in",
dpi = 300,
path = "~/Desktop/KROH/figures")
