pattern_fill="black",
pattern_angle=45,
pattern_density=0.1,
pattern_spacing=0.025,
pattern_key_scale_factor = 0.6) +
scale_fill_manual(values = c("#93F98B","#FFC100","#B589FF","#9E4693")) +
scale_pattern_manual(values = c(dhet="stripe", dhom="none"),
labels=c(dhom="homozygotes", dhet="heterozygotes")) +
facet_grid(mut~h, scales = "free_y") +
theme(
legend.title = element_blank(),
legend.position = "bottom",
panel.background = element_blank(),
panel.border = element_rect(fill=NA, color="black"),
strip.text = element_text(color="white"),
strip.background = element_rect(fill="black", color=NA),
axis.text.x = element_blank(),
axis.ticks.x = element_blank(),
axis.text.y = element_text(size=8, color="black"),
axis.text = element_text(color="black", size=8),
axis.title.x = element_blank()) +
guides(fill="none") +
ylab("Average Difference")
rab_plot
zygd_sum <- zygd_m %>%
group_by(mut, zygosity, h) %>%
summarise(
mean_diff = mean(diff, na.rm = TRUE),
q025 = quantile(diff, 0.025, na.rm = TRUE),
q975 = quantile(diff, 0.975, na.rm = TRUE))
zygd_sum$mut <- factor(zygd_sum$mut, levels = c("strong", "moderate", "mild", "neutral"))
ggplot(zygd_sum,aes(x=1, y=mean_diff, fill=mut, pattern=zygosity)) +
geom_hline(yintercept = 0, color="black") +
geom_errorbar(aes(ymin = q025, ymax = q975),position = pd, width = 0.2) +
geom_bar_pattern(stat = "identity", position = pd, width = 0.9,
color = "black",
pattern_fill="black",
pattern_angle=45,
pattern_density=0.1,
pattern_spacing=0.025,
pattern_key_scale_factor = 0.6) +
scale_fill_manual(values = c("#93F98B","#FFC100","#B589FF","#9E4693")) +
scale_pattern_manual(values = c(dhet="stripe", dhom="none"),
labels=c(dhom="homozygotes", dhet="heterozygotes")) +
facet_grid(mut~h, scales = "free_y") +
theme(
legend.title = element_blank(),
legend.position = "bottom",
panel.background = element_blank(),
panel.border = element_rect(fill=NA, color="black"),
strip.text = element_text(color="white"),
strip.background = element_rect(fill="black", color=NA),
axis.text.x = element_blank(),
axis.ticks.x = element_blank(),
axis.text.y = element_text(size=8, color="black"),
axis.text = element_text(color="black", size=8),
axis.title.x = element_blank()) +
guides(fill="none") +
ylab("Average Difference")
ggplot(zygd_sum,aes(x=1, y=mean_diff, fill=mut, pattern=zygosity)) +
geom_hline(yintercept = 0, color="black") +
geom_errorbar(aes(ymin = q025, ymax = q975),position = pd, width = 0.2) +
geom_bar_pattern(stat = "identity", position = pd, width = 0.9,
color = "black",
pattern_fill="black",
pattern_angle=45,
pattern_density=0.1,
pattern_spacing=0.025,
pattern_key_scale_factor = 0.6) +
scale_fill_manual(values = c("#9E4693", "#B589FF","#FFC100","#93F98B",)) +
scale_pattern_manual(values = c(dhet="stripe", dhom="none"),
labels=c(dhom="homozygotes", dhet="heterozygotes")) +
facet_grid(mut~h, scales = "free_y") +
theme(
legend.title = element_blank(),
legend.position = "bottom",
panel.background = element_blank(),
panel.border = element_rect(fill=NA, color="black"),
strip.text = element_text(color="white"),
strip.background = element_rect(fill="black", color=NA),
axis.text.x = element_blank(),
axis.ticks.x = element_blank(),
axis.text.y = element_text(size=8, color="black"),
axis.text = element_text(color="black", size=8),
axis.title.x = element_blank()) +
guides(fill="none") +
ylab("Average Difference")
ggplot(zygd_sum,aes(x=1, y=mean_diff, fill=mut, pattern=zygosity)) +
geom_hline(yintercept = 0, color="black") +
geom_errorbar(aes(ymin = q025, ymax = q975),position = pd, width = 0.2) +
geom_bar_pattern(stat = "identity", position = pd, width = 0.9,
color = "black",
pattern_fill="black",
pattern_angle=45,
pattern_density=0.1,
pattern_spacing=0.025,
pattern_key_scale_factor = 0.6) +
scale_fill_manual(values = c("#9E4693", "#B589FF","#FFC100","#93F98B")) +
scale_pattern_manual(values = c(dhet="stripe", dhom="none"),
labels=c(dhom="homozygotes", dhet="heterozygotes")) +
facet_grid(mut~h, scales = "free_y") +
theme(
legend.title = element_blank(),
legend.position = "bottom",
panel.background = element_blank(),
panel.border = element_rect(fill=NA, color="black"),
strip.text = element_text(color="white"),
strip.background = element_rect(fill="black", color=NA),
axis.text.x = element_blank(),
axis.ticks.x = element_blank(),
axis.text.y = element_text(size=8, color="black"),
axis.text = element_text(color="black", size=8),
axis.title.x = element_blank()) +
guides(fill="none") +
ylab("Average Difference")
knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)
library(ggpubr)
library(tidyr)
library(dplyr)
library(reshape2)
library(ggpattern)
setwd("~/Desktop/KROH/data/slim/results")
#rab
df <- read.table("results.txt",
sep="\t",
header = FALSE,
col.names = c("mut","n_sites","rab", "ahom","ahet","bhom","bhet","h","rep"))
rab <- na.omit(df)
rab$mut <- factor(rab$mut, levels = c("neutral", "mild", "moderate", "strong"))
#zygosity relative difference
rab$dhom <- ((rab$bhom-rab$ahom))
rab$dhet <- ((rab$bhet-rab$ahet))
zygd <- rab[,c("mut", "h", "dhom","dhet")]
zygd_m <- melt(zygd, id=c("mut", "h"), variable.name = "zygosity", value.name = "diff")
zygd_sum <- zygd_m %>%
group_by(mut, zygosity, h) %>%
summarise(
mean_diff = mean(diff, na.rm = TRUE),
q025 = quantile(diff, 0.025, na.rm = TRUE),
q975 = quantile(diff, 0.975, na.rm = TRUE))
zygd_sum$mut <- factor(zygd_sum$mut, levels = c("strong", "moderate", "mild", "neutral"))
pd <- position_dodge(width = 0.9)
zyg_plot <- ggplot(zygd_sum,aes(x=1, y=mean_diff, fill=mut, pattern=zygosity)) +
geom_hline(yintercept = 0, color="black") +
geom_errorbar(aes(ymin = q025, ymax = q975),position = pd, width = 0.2) +
geom_bar_pattern(stat = "identity", position = pd, width = 0.9,
color = "black",
pattern_fill="black",
pattern_angle=45,
pattern_density=0.1,
pattern_spacing=0.025,
pattern_key_scale_factor = 0.6) +
scale_fill_manual(values = c("#9E4693", "#B589FF","#FFC100","#93F98B")) +
scale_pattern_manual(values = c(dhet="stripe", dhom="none"),
labels=c(dhom="homozygotes", dhet="heterozygotes")) +
facet_grid(mut~h, scales = "free_y") +
theme(
legend.title = element_blank(),
legend.position = "bottom",
panel.background = element_blank(),
panel.border = element_rect(fill=NA, color="black"),
strip.text = element_text(color="white"),
strip.background = element_rect(fill="black", color=NA),
axis.text.x = element_blank(),
axis.ticks.x = element_blank(),
axis.text.y = element_text(size=8, color="black"),
axis.text = element_text(color="black", size=8),
axis.title.x = element_blank()) +
guides(fill="none") +
ylab("Average Difference")
ggarrange(rab_plot, zyg_plot, labels = c("A","B"))
ggplot(zygd_sum,aes(x=1, y=mean_diff, fill=mut, pattern=zygosity)) +
geom_hline(yintercept = 0, color="black") +
geom_errorbar(aes(ymin = q025, ymax = q975),position = pd, width = 0.2) +
geom_bar_pattern(stat = "identity", position = pd, width = 0.9,
color = "black",
pattern_fill="black",
pattern_angle=45,
pattern_density=0.1,
pattern_spacing=0.025,
pattern_key_scale_factor = 0.6) +
scale_fill_manual(values = c("#9E4693", "#B589FF","#FFC100","#93F98B")) +
scale_pattern_manual(values = c(dhet="stripe", dhom="none"),
labels=c(dhom="homozygotes", dhet="heterozygotes")) +
facet_grid(mut~h, scales = "free_y") +
theme(
legend.title = element_blank(),
legend.position = "bottom",
panel.background = element_blank(),
panel.border = element_rect(fill=NA, color="black"),
strip.text = element_text(color="white"),
strip.background = element_rect(fill="black", color=NA),
axis.text.x = element_blank(),
axis.ticks.x = element_blank(),
axis.text.y = element_text(size=8, color="black"),
axis.text = element_text(color="black", size=8),
axis.title.x = element_blank()) +
guides(fill="none") +
ylab("Average Difference")
ggplot(zygd_sum,aes(x=1, y=mean_diff, fill=mut, pattern=zygosity)) +
geom_hline(yintercept = 0, color="black") +
geom_errorbar(aes(ymin = q025, ymax = q975),position = pd, width = 0.2) +
geom_bar_pattern(stat = "identity", position = pd, width = 0.9,
color = "black",
pattern_fill="black",
pattern_angle=45,
pattern_density=0.1,
pattern_spacing=0.025,
pattern_key_scale_factor = 0.6) +
scale_fill_manual(values = c("#9E4693", "#B589FF","#FFC100","#93F98B")) +
scale_pattern_manual(values = c(dhet="stripe", dhom="none"),
labels=c(dhom="homozygotes", dhet="heterozygotes")) +
facet_grid(mut~h, scales = "free_y") +
theme(
legend.title = element_blank(),
legend.position = "bottom",
panel.background = element_blank(),
panel.border = element_rect(fill=NA, color="black"),
strip.text = element_text(color="white"),
strip.background = element_rect(fill="black", color=NA),
axis.text.x = element_blank(),
axis.ticks.x = element_blank(),
axis.text.y = element_text(size=8, color="black"),
#axis.text = element_text(color="black", size=8),
axis.title.x = element_blank()) +
guides(fill="none") +
ylab("Average Difference")
ggarrange(rab_plot, zyg_plot, labels = c("A","B"))
pd <- position_dodge(width = 0.9)
zyg_plot <- ggplot(zygd_sum,aes(x=1, y=mean_diff, fill=mut, pattern=zygosity)) +
geom_hline(yintercept = 0, color="black") +
geom_errorbar(aes(ymin = q025, ymax = q975),position = pd, width = 0.2) +
geom_bar_pattern(stat = "identity", position = pd, width = 0.9,
color = "black",
pattern_fill="black",
pattern_angle=45,
pattern_density=0.1,
pattern_spacing=0.025,
pattern_key_scale_factor = 0.6,
raster=FALSE) +
scale_fill_manual(values = c("#9E4693", "#B589FF","#FFC100","#93F98B")) +
scale_pattern_manual(values = c(dhet="stripe", dhom="none"),
labels=c(dhom="homozygotes", dhet="heterozygotes")) +
facet_grid(mut~h, scales = "free_y") +
theme(
legend.title = element_blank(),
legend.position = "bottom",
panel.background = element_blank(),
panel.border = element_rect(fill=NA, color="black"),
strip.text = element_text(color="white"),
strip.background = element_rect(fill="black", color=NA),
axis.text.x = element_blank(),
axis.ticks.x = element_blank(),
axis.text.y = element_text(size=8, color="black"),
#axis.text = element_text(color="black", size=8),
axis.title.x = element_blank()) +
guides(fill="none") +
ylab("Average Difference")
ggarrange(rab_plot, zyg_plot, labels = c("A","B"))
pd <- position_dodge(width = 0.9)
zyg_plot <- ggplot(zygd_sum,aes(x=1, y=mean_diff, fill=mut, alpha=zygosity)) +
geom_hline(yintercept = 0, color="black") +
geom_errorbar(aes(ymin = q025, ymax = q975),position = pd, width = 0.2) +
geom_bar(stat = "identity", position = pd, width = 0.9, color = "black")+
scale_fill_manual(values = c("#9E4693", "#B589FF","#FFC100","#93F98B")) +
scale_pattern_manual(values = c(dhet="stripe", dhom="none"),
labels=c(dhom="homozygotes", dhet="heterozygotes")) +
facet_grid(mut~h, scales = "free_y") +
theme(
legend.title = element_blank(),
legend.position = "bottom",
panel.background = element_blank(),
panel.border = element_rect(fill=NA, color="black"),
strip.text = element_text(color="white"),
strip.background = element_rect(fill="black", color=NA),
axis.text.x = element_blank(),
axis.ticks.x = element_blank(),
axis.text.y = element_text(size=8, color="black"),
axis.text = element_text(color="black", size=8),
axis.title.x = element_blank()) +
guides(fill="none") +
ylab("Average Difference")
zyg_plot
ggplot(zygd_sum,aes(x=1, y=mean_diff, fill=mut, alpha=zygosity)) +
geom_hline(yintercept = 0, color="black") +
geom_bar(stat = "identity", position = pd, width = 0.9, color = "black") +
geom_errorbar(aes(ymin = q025, ymax = q975),position = pd, width = 0.2) +
scale_fill_manual(values = c("#9E4693", "#B589FF","#FFC100","#93F98B")) +
scale_alpha_manual(values = c(0.7,1)) =
facet_grid(mut~h, scales = "free_y") +
theme(
legend.title = element_blank(),
legend.position = "bottom",
panel.background = element_blank(),
panel.border = element_rect(fill=NA, color="black"),
strip.text = element_text(color="white"),
strip.background = element_rect(fill="black", color=NA),
axis.text.x = element_blank(),
axis.ticks.x = element_blank(),
axis.text.y = element_text(size=8, color="black"),
axis.text = element_text(color="black", size=8),
axis.title.x = element_blank()) +
guides(fill="none") +
ylab("Average Difference")
ggplot(zygd_sum,aes(x=1, y=mean_diff, fill=mut, alpha=zygosity)) +
geom_hline(yintercept = 0, color="black") +
geom_bar(stat = "identity", position = pd, width = 0.9, color = "black") +
geom_errorbar(aes(ymin = q025, ymax = q975),position = pd, width = 0.2) +
scale_fill_manual(values = c("#9E4693", "#B589FF","#FFC100","#93F98B")) +
scale_alpha_manual(values = c(0.7,1)) =
facet_grid(mut~h, scales = "free_y")
ggplot(zygd_sum,aes(x=1, y=mean_diff, fill=mut, alpha=zygosity)) +
geom_hline(yintercept = 0, color="black") +
geom_bar(stat = "identity", position = pd, width = 0.9, color = "black") +
geom_errorbar(aes(ymin = q025, ymax = q975),position = pd, width = 0.2)
ggplot(zygd_sum,aes(x=1, y=mean_diff, fill=mut, alpha=zygosity)) +
geom_hline(yintercept = 0, color="black") +
geom_bar(stat = "identity", position = pd, width = 0.9, color = "black") +
geom_errorbar(aes(ymin = q025, ymax = q975),position = pd, width = 0.2) +
scale_fill_manual(values = c("#9E4693", "#B589FF","#FFC100","#93F98B")) +
scale_alpha_manual(values = c(0.7,1)) +
facet_grid(mut~h, scales = "free_y")
ggplot(zygd_sum,aes(x=1, y=mean_diff, fill=mut, alpha=zygosity)) +
geom_hline(yintercept = 0, color="black") +
geom_bar(stat = "identity", position = pd, width = 0.9, color = "black") +
geom_errorbar(aes(ymin = q025, ymax = q975),position = pd, width = 0.2) +
scale_fill_manual(values = c("#9E4693", "#B589FF","#FFC100","#93F98B")) +
scale_alpha_manual(values = c(0.5,1)) +
facet_grid(mut~h, scales = "free_y") +
theme(
legend.title = element_blank(),
legend.position = "bottom",
panel.background = element_blank(),
panel.border = element_rect(fill=NA, color="black"),
strip.text = element_text(color="white"),
strip.background = element_rect(fill="black", color=NA),
axis.text.x = element_blank(),
axis.ticks.x = element_blank(),
axis.text.y = element_text(size=8, color="black"),
axis.text = element_text(color="black", size=8),
axis.title.x = element_blank()) +
guides(fill="none") +
ylab("Average Difference")
ggplot(zygd_sum,aes(x=1, y=mean_diff, fill=mut, alpha=zygosity)) +
geom_hline(yintercept = 0, color="black") +
geom_bar(stat = "identity", position = pd, width = 0.9, color = "black") +
geom_errorbar(aes(ymin = q025, ymax = q975),position = pd, width = 0.2) +
scale_fill_manual(values = c("#9E4693", "#B589FF","#FFC100","#93F98B")) +
scale_alpha_manual(values = c(0.3,1)) +
facet_grid(mut~h, scales = "free_y") +
theme(
legend.title = element_blank(),
legend.position = "bottom",
panel.background = element_blank(),
panel.border = element_rect(fill=NA, color="black"),
strip.text = element_text(color="white"),
strip.background = element_rect(fill="black", color=NA),
axis.text.x = element_blank(),
axis.ticks.x = element_blank(),
axis.text.y = element_text(size=8, color="black"),
axis.text = element_text(color="black", size=8),
axis.title.x = element_blank()) +
guides(fill="none") +
ylab("Average Difference")
pd <- position_dodge(width = 0.9)
zyg_plot <- ggplot(zygd_sum,aes(x=1, y=mean_diff, fill=mut, alpha=zygosity)) +
geom_hline(yintercept = 0, color="black") +
geom_bar(stat = "identity", position = pd, width = 0.9, color = "black") +
geom_errorbar(aes(ymin = q025, ymax = q975),position = pd, width = 0.2) +
scale_fill_manual(values = c("#9E4693", "#B589FF","#FFC100","#93F98B")) +
scale_alpha_manual(values = c(0.3,1)) +
facet_grid(mut~h, scales = "free_y") +
theme(
legend.title = element_blank(),
legend.position = "bottom",
panel.background = element_blank(),
panel.border = element_rect(fill=NA, color="black"),
strip.text = element_text(color="white"),
strip.background = element_rect(fill="black", color=NA),
axis.text.x = element_blank(),
axis.ticks.x = element_blank(),
axis.text.y = element_text(size=8, color="black"),
axis.text = element_text(color="black", size=8),
axis.title.x = element_blank()) +
guides(fill="none") +
ylab("Average Difference")
ggarrange(rab_plot, zyg_plot, labels = c("A","B"))
ggplot(zygd_sum,aes(x=1, y=mean_diff, fill=mut, alpha=zygosity)) +
geom_hline(yintercept = 0, color="black") +
geom_bar(stat = "identity", position = pd, width = 0.9, color = "black") +
geom_errorbar(aes(ymin = q025, ymax = q975),position = pd, width = 0.2) +
scale_fill_manual(values = c("#9E4693", "#B589FF","#FFC100","#93F98B")) +
scale_alpha_manual(values = c(0.3,1), labels=c(dhom="homozygotes", dhet="heterozygotes")) +
facet_grid(mut~h, scales = "free_y") +
theme(
legend.title = element_blank(),
legend.position = "bottom",
panel.background = element_blank(),
panel.border = element_rect(fill=NA, color="black"),
strip.text = element_text(color="white"),
strip.background = element_rect(fill="black", color=NA),
axis.text.x = element_blank(),
axis.ticks.x = element_blank(),
axis.text.y = element_text(size=8, color="black"),
axis.text = element_text(color="black", size=8),
axis.title.x = element_blank()) +
guides(fill="none") +
ylab("Average Difference")
ggarrange(rab_plot, zyg_plot, labels = c("A","B"))
ggplot(zygd_sum,aes(x=1, y=mean_diff, fill=mut, alpha=zygosity)) +
geom_hline(yintercept = 0, color="black") +
geom_bar(stat = "identity", position = pd, width = 0.9, color = "black") +
geom_errorbar(aes(ymin = q025, ymax = q975),position = pd, width = 0.2) +
scale_fill_manual(values = c("#9E4693", "#B589FF","#FFC100","#93F98B")) +
scale_alpha_manual(values = c(0.3,1),
labels=c(dhom="homozygotes", dhet="heterozygotes")) +
facet_grid(mut~h, scales = "free_y") +
theme(
legend.title = element_blank(),
legend.position = "bottom",
panel.background = element_blank(),
panel.border = element_rect(fill=NA, color="black"),
strip.text = element_text(color="white"),
strip.background = element_rect(fill="black", color=NA),
axis.text.x = element_blank(),
axis.ticks.x = element_blank(),
axis.text.y = element_text(size=8, color="black"),
axis.text = element_text(color="black", size=8),
axis.title.x = element_blank()) +
guides(fill="none") +
ylab("Average Difference")
ggplot(zygd_sum,aes(x=1, y=mean_diff, fill=mut, alpha=zygosity)) +
geom_hline(yintercept = 0, color="black") +
geom_bar(stat = "identity", position = pd, width = 0.9, color = "black") +
geom_errorbar(aes(ymin = q025, ymax = q975),position = pd, width = 0.2) +
scale_fill_manual(values = c("#9E4693", "#B589FF","#FFC100","#93F98B")) +
scale_alpha_manual(values = c(0.3,1),
labels=c(dhom="homozygotes", dhet="heterozygotes")) +
facet_grid(mut~h, scales = "free_y") +
theme(
legend.title = element_blank(),
legend.position = "right",
panel.background = element_blank(),
panel.border = element_rect(fill=NA, color="black"),
strip.text = element_text(color="white"),
strip.background = element_rect(fill="black", color=NA),
axis.text.x = element_blank(),
axis.ticks.x = element_blank(),
axis.text.y = element_text(size=8, color="black"),
axis.text = element_text(color="black", size=8),
axis.title.x = element_blank()) +
guides(fill="none") +
ylab("Average Difference")
pd <- position_dodge(width = 0.9)
zyg_plot <- ggplot(zygd_sum,aes(x=1, y=mean_diff, fill=mut, alpha=zygosity)) +
geom_hline(yintercept = 0, color="black") +
geom_bar(stat = "identity", position = pd, width = 0.9, color = "black") +
geom_errorbar(aes(ymin = q025, ymax = q975),position = pd, width = 0.2) +
scale_fill_manual(values = c("#9E4693", "#B589FF","#FFC100","#93F98B")) +
scale_alpha_manual(values = c(0.3,1),
labels=c(dhom="homozygotes", dhet="heterozygotes")) +
facet_grid(mut~h, scales = "free_y") +
theme(
legend.title = element_blank(),
legend.position = "right",
panel.background = element_blank(),
panel.border = element_rect(fill=NA, color="black"),
strip.text = element_text(color="white"),
strip.background = element_rect(fill="black", color=NA),
axis.text.x = element_blank(),
axis.ticks.x = element_blank(),
axis.text.y = element_text(size=8, color="black"),
axis.text = element_text(color="black", size=8),
axis.title.x = element_blank()) +
guides(fill="none") +
ylab("Average Difference")
ggarrange(rab_plot, zyg_plot, labels = c("A","B"))
pd <- position_dodge(width = 0.9)
zyg_plot <- ggplot(zygd_sum,aes(x=1, y=mean_diff, fill=mut, alpha=zygosity)) +
geom_hline(yintercept = 0, color="black") +
geom_bar(stat = "identity", position = pd, width = 0.9, color = "black") +
geom_errorbar(aes(ymin = q025, ymax = q975),position = pd, width = 0.2) +
scale_fill_manual(values = c("#9E4693", "#B589FF","#FFC100","#93F98B")) +
scale_alpha_manual(values = c(0.3,1),
labels=c(dhom="homozygotes", dhet="heterozygotes")) +
facet_grid(mut~h, scales = "free_y") +
theme(
legend.title = element_blank(),
legend.position = "bottom",
panel.background = element_blank(),
panel.border = element_rect(fill=NA, color="black"),
strip.text = element_text(color="white"),
strip.background = element_rect(fill="black", color=NA),
axis.text.x = element_blank(),
axis.ticks.x = element_blank(),
axis.text.y = element_text(size=8, color="black"),
axis.text = element_text(color="black", size=8),
axis.title.x = element_blank()) +
guides(fill="none") +
ylab("Average Difference")
ggarrange(rab_plot, zyg_plot, labels = c("A","B"))
sim_plots <-
ggarrange(rab_plot, zyg_plot, labels = c("A","B"))
ggsave(filename = "rab_sims_plot.png",
plot = sim_plots,
width = 7,
height = 4,
units = "in",
dpi = 300,
path = "~/Desktop/KROH/figures")
zyg_plot
