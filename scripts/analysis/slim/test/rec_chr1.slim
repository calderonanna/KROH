initialize(){
	
	initializeMutationType("m1", 0.5, "f", 0);
	initializeMutationType("m2", 0.0, "g", -0.03, 0.2);
	initializeGenomicElementType("g1", c(m1,m2), c(9,1));
	initializeGenomicElementType("g2", m1, 1);
	
	//CHR1
	initializeChromosome(id=1, length=114063801);
	exons = readFile("/storage/group/zps5164/default/abc6435/KROH/data/slim/genome_structure/exon_chr1.txt");
	for (exon in exons)
	{
		components = strsplit(exon, "\t");
		initializeGenomicElement(g1, asInteger(components[0])-1, asInteger(components[1])-1);
	}
	
	intergenics = readFile("/storage/group/zps5164/default/abc6435/KROH/data/slim/genome_structure/intergenic_chr1.txt");
	for (intergenic in intergenics)
	{
		components = strsplit(intergenic, "\t");
		initializeGenomicElement(g2, asInteger(components[0])-1, asInteger(components[1])-1);
	}
	
	initializeMutationRate(4e-7);
	initializeRecombinationRate(5e-9);
}


// SIMULATE POPULATION
1 early() {
	sim.addSubpop("p1", 700);
}

10000 early() {
	p1.setSubpopulationSize(259);
}

10500 early() {
	inds = p1.sampleIndividuals(6); // 1900's samples
	inds.outputIndividuals();
	inds.outputIndividualsToVCF(filePath="/storage/group/zps5164/default/abc6435/KROH/data/slim/vcf/hKIWA_rec.vcf");
}

10550 early() {
	p1.setSubpopulationSize(161); //1950's bottleneck
}

10606 early() {
	inds = p1.sampleIndividuals(7); // 2000's samples
	inds.outputIndividuals();
	inds.outputIndividualsToVCF(filePath="/storage/group/zps5164/default/abc6435/KROH/data/slim/vcf/cKIWA_rec.vcf");
}

10620 late() {
}
