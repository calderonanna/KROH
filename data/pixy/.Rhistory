panel.background = element_blank(),
panel.grid.minor.x = element_line(linetype="dashed", color="black", linewidth=.05),
panel.border = element_rect(color="black", fill=NA),
axis.title.y = element_blank(),
axis.text.x = element_text(size=8, color="black"),
axis.text.y = element_text(size=8, color="black"),
legend.position = "bottom") +
xlab("RAB")
ggsave("rab.png", plot=rab_plot,
path ="~/Desktop/KROH/figures",
width = 3, height = 4, units = "in", dpi = 300)
colors = c(
"lossoffunction"="#FF12B4",
"deleterious"="#C870E0",
"nonsynonymous"="#7083E0",
"tolerated"="#70E0CA",
"synonymous"="#C1E070",
"noncoding"="#FFD400"
)
rab_plot <- ggplot(rab, aes(y=NUM, fill=MUT, alpha=NEUTRAL)) +
geom_rect(aes(xmin=1, xmax=AVG, ymin=NUM-0.4, ymax=NUM+0.4),
color="black") +
geom_point(aes(x=RAB, y=NUM),size = 1) +
scale_alpha_manual(values=c(1,0.5), name=NULL) +
scale_fill_manual(values = colors, guide="none") +
geom_errorbarh(aes(xmin = Q25, xmax = Q97, y = NUM), height = 0.2) +
scale_x_continuous(limits=c(0,1.5), breaks=seq(0,1.5,0.2)) +
scale_y_continuous(
breaks = c(1.5,4.5,7.5,10.5,13.5,16.5),
labels = unique(rab$MUT)) +
geom_vline(xintercept = 1.0, color="black") +
theme(
panel.background = element_blank(),
panel.grid.minor.x = element_line(linetype="dashed", color="black", linewidth=.05),
panel.border = element_rect(color="black", fill=NA),
axis.title.y = element_blank(),
axis.text.x = element_text(size=8, color="black"),
axis.text.y = element_text(size=8, color="black"),
legend.position = "bottom") +
xlab("RAB")
ggsave("rab.png", plot=rab_plot,
path ="~/Desktop/KROH/figures",
width = 3, height = 4, units = "in", dpi = 300)
ggsave("rab.png", plot=rab_plot,
path ="~/Desktop/KROH/figures",
width = 4, height = 4, units = "in", dpi = 300)
ggsave("rab.png", plot=rab_plot,
path ="~/Desktop/KROH/figures",
width = 4, height = 3, units = "in", dpi = 300)
ggsave("rab.png", plot=rab_plot,
path ="~/Desktop/KROH/figures",
width = 4, height = 5, units = "in", dpi = 300)
ggsave("rab.png", plot=rab_plot,
path ="~/Desktop/KROH/figures",
width = 4, height = 4.5, units = "in", dpi = 300)
knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)
library(ggpubr)
library(tidyr)
library(dplyr)
setwd("~/Desktop/KROH/data/slim/rxy")
rxy <- read.table("rxy.txt",
header = FALSE,
na.strings = c("nan", "NaN", "NA", "."))
rxy <- na.omit(rxy)
colnames(rxy) <- c("rxy", "q025", "q975", "s", "h","rep")
rownames(rxy) <- NULL
rxy$rxy_y <- as.numeric(rownames(rxy))
rxy$h <- factor(rxy$h, levels = c("h00","h05","h10"))
P1=c("#1AABFF","#FFE01A","#FF1A39")
P2=c("#8FD3FF","#FFF48F","#FF8F9A")
rxy_slim <-
ggplot(rxy[rxy$rxy<2,], aes(x=rxy, y=s, fill=h)) +
geom_violin(alpha=0.5, color="black", width=1.0) +
geom_boxplot(width=0.05, color="black", outlier.shape = NA) +
geom_jitter(shape = 16, height = 0.05, size=0.3, alpha=0.3) +
scale_fill_manual(values = P1) +
geom_vline(xintercept = 1.0,
color="black",
linetype="dashed",
linewidth=0.15) +
facet_wrap(~h, ncol=3, scales="free_x") +
xlab("RAB") +
theme(
panel.background = element_blank(),
panel.border = element_rect(fill=NA, color="black"),
legend.position="none",
strip.text = element_text(color="white"),
strip.background = element_rect(fill="black", color=NA),
axis.text = element_text(color="black")
)
ggsave(filename = "rab_slim.png",
plot = rxy_slim,
width = 6,
height = 6,
units = "in",
dpi = 300,
path = "~/Desktop/KROH/figures/")
P1=c("#1AABFF","#FFE01A","#FF1A39")
P2=c("#8FD3FF","#FFF48F","#FF8F9A")
rxy_slim <-
ggplot(rxy[rxy$rxy<2,], aes(x=rxy, y=s, fill=h)) +
geom_violin(alpha=0.5, color="black", width=1.0) +
geom_boxplot(width=0.05, color="black", outlier.shape = NA) +
geom_jitter(shape = 16, height = 0.05, size=0.3, alpha=0.3) +
scale_fill_manual(values = P1) +
geom_vline(xintercept = 1.0,
color="black",
linetype="dashed",
linewidth=0.15) +
facet_wrap(~h, ncol=3, scales="free_x") +
xlab("RAB") +
theme(
panel.background = element_blank(),
panel.border = element_rect(fill=NA, color="black"),
legend.position="none",
strip.text = element_text(color="white"),
strip.background = element_rect(fill="black", color=NA),
axis.text = element_text(color="black")
)
rxy_slim
ggsave(filename = "rab_slim.png",
plot = rxy_slim,
width = 6,
height = 6,
units = "in",
dpi = 300,
path = "~/Desktop/KROH/figures/")
ggsave(filename = "rab_slim.png",
plot = rxy_slim,
width = 6,
height = 6,
units = "in",
dpi = 300,
path = "~/Desktop/KROH/figures")
rxy_slim
ggsave(filename = "rab_slim.png",
plot = rxy_slim,
width = 6,
height = 6,
units = "in",
dpi = 300,
path = "~/Desktop/KROH/figures")
P1=c("#1AABFF","#FFE01A","#FF1A39")
P2=c("#8FD3FF","#FFF48F","#FF8F9A")
rxy_slim <-
ggplot(rxy[rxy$rxy<2,], aes(x=rxy, y=s, fill=h)) +
geom_violin(alpha=0.5, color="black", width=1.0) +
geom_boxplot(width=0.05, color="black", outlier.shape = NA) +
geom_jitter(shape = 16, height = 0.05, size=0.3, alpha=0.3) +
scale_fill_manual(values = P1) +
geom_vline(xintercept = 1.0,
color="black",
linetype="dashed",
linewidth=0.15) +
facet_wrap(~h, ncol=3, scales="free_x") +
xlab("RAB") +
theme(
panel.background = element_blank(),
panel.border = element_rect(fill=NA, color="black"),
legend.position="none",
strip.text = element_text(color="white"),
strip.background = element_rect(fill="black", color=NA),
axis.text = element_text(color="black")
)
P1=c("#1AABFF","#FFE01A","#FF1A39")
P2=c("#8FD3FF","#FFF48F","#FF8F9A")
rxy_slim <-
ggplot(rxy[rxy$rxy<2,], aes(x=rxy, y=s, fill=h)) +
geom_violin(alpha=0.5, color="black", width=1.0) +
geom_boxplot(width=0.05, color="black", outlier.shape = NA) +
geom_jitter(shape = 16, height = 0.05, size=0.3, alpha=0.3) +
scale_fill_manual(values = P1) +
geom_vline(xintercept = 1.0,
color="black",
linetype="dashed",
linewidth=0.15) +
facet_wrap(~h, ncol=3, scales="free_x") +
xlab("RAB") +
theme(
panel.background = element_blank(),
panel.border = element_rect(fill=NA, color="black"),
legend.position="none",
strip.text = element_text(color="white"),
strip.background = element_rect(fill="black", color=NA),
axis.text = element_text(color="black")
)
P1=c("#1AABFF","#FFE01A","#FF1A39")
P2=c("#8FD3FF","#FFF48F","#FF8F9A")
rxy_slim <-
ggplot(rxy[rxy$rxy<2,], aes(x=rxy, y=s, fill=h)) +
geom_violin(alpha=0.5, color="black", width=1.0) +
geom_boxplot(width=0.05, color="black", outlier.shape = NA) +
geom_jitter(shape = 16, height = 0.05, size=0.3, alpha=0.3) +
scale_fill_manual(values = P1) +
geom_vline(xintercept = 1.0,
color="black",
linetype="dashed",
linewidth=0.15) +
facet_wrap(~h, ncol=3, scales="free_x") +
xlab("RAB") +
theme(
panel.background = element_blank(),
panel.border = element_rect(fill=NA, color="black"),
legend.position="none",
strip.text = element_text(color="white"),
strip.background = element_rect(fill="black", color=NA),
axis.text = element_text(color="black")
)
ggsave(filename = "rab_slim.png",
plot = rxy_slim,
width = 6,
height = 6,
units = "in",
dpi = 300,
path = "~/Desktop/KROH/figures")
ggsave(filename = "rab_slim_plot.png",
plot = rxy_slim,
width = 6,
height = 6,
units = "in",
dpi = 300,
path = "~/Desktop/KROH/figures")
knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)
library(tidyverse)
library(dplyr)
library(reshape2)
setwd("~/Desktop/KROH/data/pixy")
df <- read.table("window_pi.txt", header = TRUE)
df <- na.omit(df)
df
setwd("~/Desktop/KROH/data/pixy")
df <- read.table("window_pi.txt", header = TRUE)
pi <- na.omit(df)
setwd("~/Desktop/KROH/data/pixy")
df <- read.table("window_pi.txt", header = TRUE)
pi <- na.omit(df)
pi$chromosome <- factor(pi$chromosome, levels = unique(pi$chromosome))
pi
ggplot(pi, aes(x = window_pos_2, y = avg_pi, color=pop)) +
geom_line(alpha=0.7)
ggplot(pi, aes(x = window_pos_2, y = avg_pi, color=pop)) +
geom_line(alpha=0.7) +
scale_color_manual(values=c("gray","black")) +
facet_grid(. ~ chromosome, scales = "free_x", space = "free_x", switch="x")
ggplot(pi, aes(x = window_pos_2, y = avg_pi, color=pop)) +
geom_line(alpha=0.7) +
scale_color_manual(values=c("gray","black")) +
facet_grid(. ~ chromosome, scales = "free_x", space = "free_x", switch="x") +
theme_minimal() +
theme(axis.line = element_line(color="black"),
axis.ticks = element_blank(),
axis.text.y = element_text(size=10, color="black"),
axis.title.y = element_text(size=10, color="black"),
axis.title.x = element_blank(),
axis.text.x = element_blank(),
strip.text = element_text(size=8),
strip.text.x = element_text(angle=90, vjust = 0.5),
strip.placement = "outside",
plot.background = element_blank(),
panel.background = element_blank(),
panel.border = element_blank(),
panel.spacing = unit(0.0, 'points'),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
legend.title = element_blank()) +
labs(y = expression(pi))
ggplot(pi, aes(x = window_pos_2, y = avg_pi, color=pop)) +
geom_point(alpha=0.7) +
scale_color_manual(values=c("gray","black")) +
facet_grid(. ~ chromosome, scales = "free_x", space = "free_x", switch="x") +
theme_minimal() +
theme(axis.line = element_line(color="black"),
axis.ticks = element_blank(),
axis.text.y = element_text(size=10, color="black"),
axis.title.y = element_text(size=10, color="black"),
axis.title.x = element_blank(),
axis.text.x = element_blank(),
strip.text = element_text(size=8),
strip.text.x = element_text(angle=90, vjust = 0.5),
strip.placement = "outside",
plot.background = element_blank(),
panel.background = element_blank(),
panel.border = element_blank(),
panel.spacing = unit(0.0, 'points'),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
legend.title = element_blank()) +
labs(y = expression(pi))
ggplot(pi, aes(x = window_pos_2, y = avg_pi, color=pop)) +
geom_line(alpha=0.7) +
scale_color_manual(values=c("gray","black")) +
facet_grid(. ~ chromosome, scales = "free_x", space = "free_x", switch="x") +
theme_minimal() +
theme(axis.line = element_line(color="black"),
axis.ticks = element_blank(),
axis.text.y = element_text(size=10, color="black"),
axis.title.y = element_text(size=10, color="black"),
axis.title.x = element_blank(),
axis.text.x = element_blank(),
strip.text = element_text(size=8),
strip.text.x = element_text(angle=90, vjust = 0.5),
strip.placement = "outside",
plot.background = element_blank(),
panel.background = element_blank(),
panel.border = element_blank(),
panel.spacing = unit(0.0, 'points'),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
legend.title = element_blank()) +
labs(y = expression(pi))
ggsave(plot = pixy_pi,
"pixy_pi.png",
path = "~/Desktop/KROH/figures",
dpi=300,
units = "in",
height = 3,
weight = 7
)
pixy_pi <- ggplot(pi, aes(x = window_pos_2, y = avg_pi, color=pop)) +
geom_line(alpha=0.7) +
scale_color_manual(values=c("gray","black")) +
facet_grid(. ~ chromosome, scales = "free_x", space = "free_x", switch="x") +
theme_minimal() +
theme(axis.line = element_line(color="black"),
axis.ticks = element_blank(),
axis.text.y = element_text(size=10, color="black"),
axis.title.y = element_text(size=10, color="black"),
axis.title.x = element_blank(),
axis.text.x = element_blank(),
strip.text = element_text(size=8),
strip.text.x = element_text(angle=90, vjust = 0.5),
strip.placement = "outside",
plot.background = element_blank(),
panel.background = element_blank(),
panel.border = element_blank(),
panel.spacing = unit(0.0, 'points'),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
legend.title = element_blank()) +
labs(y = expression(pi))
ggsave(plot = pixy_pi,
"pixy_pi.png",
path = "~/Desktop/KROH/figures",
dpi=300,
units = "in",
height = 3,
weight = 7
)
ggsave(plot = pixy_pi,
"pixy_pi.png",
path = "~/Desktop/KROH/figures",
dpi=300,
units = "in",
height = 3,
width = 7
)
ggsave(plot = pixy_pi,
"pixy_pi.png",
path = "~/Desktop/KROH/figures",
dpi=300,
units = "in",
height = 3,
width = 8
)
setwd("~/Desktop/KROH/data/pixy")
df <- read.table("window_pi.txt", header = TRUE)
df <- na.omit(df)
subset(df, df$chromosome!="chrz")
knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)
library(tidyverse)
library(dplyr)
library(reshape2)
setwd("~/Desktop/KROH/data/pixy")
df <- read.table("window_pi.txt", header = TRUE)
df <- na.omit(df)
pi<- subset(df, df$chromosome!="chrz")
pi$chromosome <- factor(pi$chromosome, levels = unique(pi$chromosome))
pixy_pi <- ggplot(pi, aes(x = window_pos_2, y = avg_pi, color=pop)) +
geom_line(alpha=0.7) +
scale_color_manual(values=c("gray","black")) +
facet_grid(. ~ chromosome, scales = "free_x", space = "free_x", switch="x") +
theme_minimal() +
theme(axis.line = element_line(color="black"),
axis.ticks = element_blank(),
axis.text.y = element_text(size=10, color="black"),
axis.title.y = element_text(size=10, color="black"),
axis.title.x = element_blank(),
axis.text.x = element_blank(),
strip.text = element_text(size=8),
strip.text.x = element_text(angle=90, vjust = 0.5),
strip.placement = "outside",
plot.background = element_blank(),
panel.background = element_blank(),
panel.border = element_blank(),
panel.spacing = unit(0.0, 'points'),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
legend.title = element_blank()) +
labs(y = expression(pi))
ggsave(plot = pixy_pi,
"pixy_pi.png",
path = "~/Desktop/KROH/figures",
dpi=300,
units = "in",
height = 3,
width = 8
)
ggplot(pi, aes(x = window_pos_2, y = avg_pi, color = pop)) +
geom_line(alpha = 0.7) +
scale_color_manual(values = c("gray", "black")) +
facet_grid(chromosome ~ pop, scales = "free_x", space = "free_x", switch = "x") +
theme_minimal() +
theme(
axis.line = element_line(color = "black"),
axis.ticks = element_blank(),
axis.text.y = element_text(size = 10, color = "black"),
axis.title.y = element_text(size = 10, color = "black"),
axis.title.x = element_blank(),
axis.text.x = element_blank(),
strip.text = element_text(size = 8),
strip.text.x = element_text(angle = 90, vjust = 0.5),
strip.placement = "outside",
plot.background = element_blank(),
panel.background = element_blank(),
panel.border = element_blank(),
panel.spacing = unit(0.0, 'points'),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
legend.title = element_blank()
) +
labs(y = expression(pi))
ggplot(pi, aes(x = window_pos_2, y = avg_pi, color=pop)) +
geom_line(alpha=0.7) +
scale_color_manual(values=c("gray","black")) +
facet_grid(pop ~ chromosome, scales="free_x", space="free_x", switch="x") +
#facet_grid(. ~ chromosome, scales = "free_x", space = "free_x", switch="x") +
theme_minimal() +
theme(axis.line = element_line(color="black"),
axis.ticks = element_blank(),
axis.text.y = element_text(size=10, color="black"),
axis.title.y = element_text(size=10, color="black"),
axis.title.x = element_blank(),
axis.text.x = element_blank(),
strip.text = element_text(size=8),
strip.text.x = element_text(angle=90, vjust = 0.5),
strip.placement = "outside",
plot.background = element_blank(),
panel.background = element_blank(),
panel.border = element_blank(),
panel.spacing = unit(0.0, 'points'),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
legend.title = element_blank()) +
labs(y = expression(pi))
ggplot(pi, aes(x = window_pos_2, y = avg_pi, color=pop)) +
geom_line() +
scale_color_manual(values=c("gray","black")) +
#facet_grid(pop ~ chromosome, scales="free_x", space="free_x", switch="x") +
facet_grid(. ~ chromosome, scales = "free_x", space = "free_x", switch="x") +
theme_minimal() +
theme(axis.line = element_line(color="black"),
axis.ticks = element_blank(),
axis.text.y = element_text(size=10, color="black"),
axis.title.y = element_text(size=10, color="black"),
axis.title.x = element_blank(),
axis.text.x = element_blank(),
strip.text = element_text(size=8),
strip.text.x = element_text(angle=90, vjust = 0.5),
strip.placement = "outside",
plot.background = element_blank(),
panel.background = element_blank(),
panel.border = element_blank(),
panel.spacing = unit(0.0, 'points'),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
legend.title = element_blank()) +
labs(y = expression(pi))
pixy_pi <-
ggplot(pi, aes(x = window_pos_2, y = avg_pi, color=pop)) +
geom_line() +
scale_color_manual(values=c("gray","black")) +
#facet_grid(pop ~ chromosome, scales="free_x", space="free_x", switch="x") +
facet_grid(. ~ chromosome, scales = "free_x", space = "free_x", switch="x") +
theme_minimal() +
theme(axis.line = element_line(color="black"),
axis.ticks = element_blank(),
axis.text.y = element_text(size=10, color="black"),
axis.title.y = element_text(size=10, color="black"),
axis.title.x = element_blank(),
axis.text.x = element_blank(),
strip.text = element_text(size=8),
strip.text.x = element_text(angle=90, vjust = 0.5),
strip.placement = "outside",
plot.background = element_blank(),
panel.background = element_blank(),
panel.border = element_blank(),
panel.spacing = unit(0.0, 'points'),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
legend.title = element_blank()) +
labs(y = expression(pi))
ggsave(plot = pixy_pi,
"pixy_pi.png",
path = "~/Desktop/KROH/figures",
dpi=300,
units = "in",
height = 3,
width = 8
)
