---
title: "mapdamage_mcmc_stats"
author: "Anna Maria Calderon"
date: "2025-05-08"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)
library(dplyr)
library(tidyr)
library(ggpubr)
setwd("/Users/abc6435/Desktop/KROH/data/mapdamage/")
mcmc <- read.table("Stats_out_MCMC_iter.tsv", header = TRUE)

```

# Modify Data

```{r modify_data, include=FALSE}
mcmc$Sample <- as.character(mcmc$Sample)
```

# Plot Historical

```{r modify_data, include=FALSE}
sample_colors=c("gray",
                "gray",
                "gray",
                "gray",
                "gray",
                "gray",
                "gray",
                "black",
                "black", 
                "black", 
                "black",
                "black",
                "black")

theta <- ggplot(mcmc, aes(x=Theta, fill=Sample)) +
  geom_density(color="black") + 
  scale_fill_manual(values=sample_colors) +
  scale_x_continuous(expand = c(0,0)) +
  scale_y_continuous(expand = c(0,0)) +
  xlab(expression(theta)) +
  theme(panel.background = element_blank(),
        panel.border = element_rect(colour = "black", fill=NA),
        legend.position = "none") +
  facet_wrap(~Pop, scales = "free", ncol=2)

deltad <- ggplot(mcmc, aes(x=DeltaD, fill=Sample)) +
  geom_density(color="black", alpha=0.3) + 
  scale_fill_manual(values=sample_colors) +
  scale_x_continuous(expand = c(0,0), limits = c(0, 2e-07)) +
  scale_y_continuous(expand = c(0,0)) +
  xlab(expression(delta[d])) +
  theme(panel.background = element_blank(),
        panel.border = element_rect(colour = "black", fill=NA),
        legend.position = "none") +
  facet_wrap(~Pop, scales = "free", ncol=2)


deltas <- ggplot(mcmc, aes(x=DeltaS, fill=Sample)) +
  geom_density(color="black", alpha=0.8,  ) + 
  scale_fill_manual(values=sample_colors) +
  scale_x_continuous(expand = c(0,0)) +
  scale_y_continuous(expand = c(0,0)) +
  xlab(expression(delta[s])) +
  theme(panel.background = element_blank(),
        panel.border = element_rect(colour = "black", fill=NA),
        legend.position = "none") +
  facet_wrap(~Pop, scales = "free", ncol=2)


lambda <- ggplot(mcmc, aes(x=Lambda, fill=Sample)) +
  geom_density(color="black", alpha=0.8,  ) + 
  scale_fill_manual(values=sample_colors) +
  scale_x_continuous(expand = c(0,0)) +
  scale_y_continuous(expand = c(0,0)) +
  xlab(expression(lambda)) +
  theme(panel.background = element_blank(),
        panel.border = element_rect(colour = "black", fill=NA),
        legend.position = "none") +
  facet_wrap(~Pop, scales = "free", ncol=2)

rho <- ggplot(mcmc, aes(x=Rho, fill=Sample)) +
  geom_density(color="black", alpha=0.8,  ) + 
  scale_fill_manual(values=sample_colors) +
  scale_x_continuous(expand = c(0,0)) +
  scale_y_continuous(expand = c(0,0)) +
  xlab(expression(rho)) +
  theme(panel.background = element_blank(),
        panel.border = element_rect(colour = "black", fill=NA),
        legend.position = "none") +
  facet_wrap(~Pop, scales = "free", ncol=2)

loglik <- ggplot(mcmc, aes(x=LogLik, fill=Sample)) +
  geom_density(alpha=0.7) + 
  scale_fill_manual(values=sample_colors) +
  scale_x_continuous(expand = c(0,0)) +
  scale_y_continuous(expand = c(0,0)) +
  xlab("LogLik") +
  theme(panel.background = element_blank(),
        panel.border = element_rect(colour = "black", fill=NA),
        legend.position = "none") +
  facet_wrap(~Pop, scales = "free", ncol=2)
```

# Arrange and Save

```{r arrange_save, include=FALSE}

theta_plot <- ggarrange(theta_h, theta_c, nrow=1, ncol=2, labels = "A")
deltad_plot <- ggarrange(deltad_h, deltad_c, nrow=1, ncol=2, labels = "B")
deltas_plot <- ggarrange(deltas_h, deltas_c, nrow=1, ncol=2, labels = "C")
lambda_plot <- ggarrange(lambda_h, lambda_c, nrow=1, ncol=2, labels = "D")
rho_plot <- ggarrange(rho_h, rho_c, nrow=1, ncol=2, labels = "E")
loglik_plot <- ggarrange(loglik_h, loglik_c, nrow=1, ncol=2, labels = "F")

mcmc_par <- ggarrange(theta_plot,
                      deltad_plot,
                      deltas_plot,
                      lambda_plot,
                      rho_plot,
                      loglik_plot,
                      nrow=6)

ggsave(filename="mcmc_param.png", 
       plot = mcmc_par, 
       path = "/Users/annamariacalderon/Desktop/KROH/figures/", 
       width = 6, 
       height = 8, 
       units = "in", 
       dpi=300)
```
